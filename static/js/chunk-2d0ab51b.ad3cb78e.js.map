{"version":3,"sources":["webpack:///./src/components/Security/Password.vue?6c4d","webpack:///src/components/Security/Password.vue","webpack:///./src/components/Security/Password.vue?1645","webpack:///./src/components/Security/Password.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$vuetify","lang","t","on","$event","preventDefault","updatePassword","apply","arguments","attrs","oldpasswordErrors","$v","form","oldPassword","$touch","model","value","callback","$$v","$set","expression","passwordErrors","password","re_password","loading","staticRenderFns","mixins","Form","props","type","Object","default","id","$auth","user","data","created","getTypesRole","validations","required","component","sameAsPassword","validators","methods","getRoute","urlItems","$store","dispatch","statut","self","$invalid","getDataForm","_","isNull","setForm","item","computed","roleErrors","role","$dirty","errors","new_password","rePasswordErrors","VBtn","VCard","VCardTitle","VContainer","VDivider","VForm","VRow","VTextField"],"mappings":"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","file":"js/chunk-2d0ab51b.ad3cb78e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',[_c('v-card-title',[_c('div',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(_vm.$vuetify.lang.t(\"$vuetify.security.password2\"))+\" \")])]),_c('v-divider'),_c('v-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.updatePassword.apply(null, arguments)}}},[_c('v-container',[_c('v-text-field',{attrs:{\"autofocus\":\"\",\"color\":\"primary\",\"error-messages\":_vm.oldpasswordErrors,\"label\":_vm.$vuetify.lang.t('$vuetify.users.cols.current_password.title'),\"outlined\":\"\",\"prepend-inner-icon\":\"mdi-lock\"},on:{\"blur\":function($event){return _vm.$v.form.oldPassword.$touch()},\"input\":function($event){return _vm.$v.form.oldPassword.$touch()}},model:{value:(_vm.form.oldPassword),callback:function ($$v) {_vm.$set(_vm.form, \"oldPassword\", $$v)},expression:\"form.oldPassword\"}}),_c('v-text-field',{attrs:{\"color\":\"primary\",\"label\":_vm.$vuetify.lang.t('$vuetify.users.cols.password.title'),\"error-messages\":_vm.passwordErrors,\"type\":\"password\",\"outlined\":\"\",\"prepend-inner-icon\":\"mdi-lock\"},on:{\"blur\":function($event){return _vm.$v.form.password.$touch()},\"input\":function($event){return _vm.$v.form.password.$touch()}},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}}),_c('v-text-field',{attrs:{\"color\":\"primary\",\"label\":_vm.$vuetify.lang.t('$vuetify.users.cols.re_password.title'),\"error-messages\":_vm.passwordErrors,\"type\":\"password\",\"outlined\":\"\",\"prepend-inner-icon\":\"mdi-lock\"},on:{\"blur\":function($event){return _vm.$v.form.re_password.$touch()},\"input\":function($event){return _vm.$v.form.re_password.$touch()}},model:{value:(_vm.form.re_password),callback:function ($$v) {_vm.$set(_vm.form, \"re_password\", $$v)},expression:\"form.re_password\"}}),_c('v-row',{attrs:{\"justify\":\"center\"}},[_c('v-btn',{staticClass:\"mr-2 my-2\",attrs:{\"color\":\"primary\",\"loading\":_vm.loading,\"dark\":\"\",\"type\":\"submit\"}},[_vm._v(\" \"+_vm._s(_vm.$vuetify.lang.t(\"$vuetify.btn.save\"))+\" \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card>\n    <v-card-title>\n      <div class=\"title\">\n        {{ $vuetify.lang.t(\"$vuetify.security.password2\") }}\n      </div>\n    </v-card-title>\n    <v-divider></v-divider>\n    <v-form @submit.prevent=\"updatePassword\">\n      <v-container>\n        <v-text-field\n          autofocus\n          v-model=\"form.oldPassword\"\n          color=\"primary\"\n          @blur=\"$v.form.oldPassword.$touch()\"\n          @input=\"$v.form.oldPassword.$touch()\"\n          :error-messages=\"oldpasswordErrors\"\n          :label=\"$vuetify.lang.t('$vuetify.users.cols.current_password.title')\"\n          outlined\n          prepend-inner-icon=\"mdi-lock\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"form.password\"\n          color=\"primary\"\n          @blur=\"$v.form.password.$touch()\"\n          @input=\"$v.form.password.$touch()\"\n          :label=\"$vuetify.lang.t('$vuetify.users.cols.password.title')\"\n          :error-messages=\"passwordErrors\"\n          type=\"password\"\n          outlined\n          prepend-inner-icon=\"mdi-lock\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"form.re_password\"\n          color=\"primary\"\n          @blur=\"$v.form.re_password.$touch()\"\n          @input=\"$v.form.re_password.$touch()\"\n          :label=\"$vuetify.lang.t('$vuetify.users.cols.re_password.title')\"\n          :error-messages=\"passwordErrors\"\n          type=\"password\"\n          outlined\n          prepend-inner-icon=\"mdi-lock\"\n        ></v-text-field>\n        <v-row justify=\"center\">\n          <v-btn\n            color=\"primary\"\n            :loading=\"loading\"\n            class=\"mr-2 my-2\"\n            dark\n            type=\"submit\"\n          >\n            {{ $vuetify.lang.t(\"$vuetify.btn.save\") }}\n          </v-btn>\n        </v-row>\n      </v-container>\n    </v-form>\n  </v-card>\n</template>\n\n<script>\nimport FormMixin from \"./../../mixins/Common/Form.vue\";\n// import {mapGetters} from \"vuex\";\nimport { required, requiredIf, sameAs } from \"vuelidate/lib/validators\";\n\nexport default {\n  mixins: [FormMixin],\n  props: {\n    form: {\n      type: Object,\n      default: function () {\n        return {\n          id: this.$auth.user().id,\n          oldPassword: null,\n          password: null,\n          re_password: null,\n        };\n      },\n    },\n  },\n  data: () => ({\n    urlItems: \"/users/change-password\",\n    types: {\n      role: [],\n    },\n    itemsRoles: [],\n  }),\n  created() {\n    this.getTypesRole();\n    //this.setItemRoles();\n  },\n  validations() {\n    let validators = {\n      form: {\n        oldPassword: {\n          required,\n        },\n        password: {\n          required: requiredIf((component) => {\n            return !component[\"id\"];\n          }),\n        },\n        re_password: {\n          sameAsPassword: sameAs(\"password\"),\n        },\n      },\n    };\n    return validators;\n  },\n  methods: {\n    getRoute() {\n      if (this.form.id) {\n        return this.urlItems + \"/\" + this.form.id;\n      } else {\n        return this.urlItems;\n      }\n    },\n    updatePassword() {\n      this.$store.dispatch(\"showNotification\", {\n        statut: false,\n      });\n      let self = this;\n      self.$v.$touch();\n      if (!self.$v.$invalid) {\n        this.loading = true;\n        this.$store\n          .dispatch(\"request\", {\n            url: self.getRoute(),\n            method: \"PATCH\",\n            data: self.getDataForm(),\n          })\n          .then(() => {\n            self.$store.dispatch(\"showNotification\", {\n              statut: true,\n              text: self.$vuetify.lang.t(\n                \"$vuetify.users.cols.password.success\"\n              ),\n            });\n            self.$emit(\"getItems\");\n            self.resetDataForm();\n          })\n          .catch((error) => {\n            let message = \"$vuetify.error_server\";\n\n            if (error.response) {\n              if (error.response.status === 400) {\n                const fields = error.response.data;\n                self.setFormErrors(fields);\n                this.$forceUpdate();\n\n                const firstField = Object.keys(fields)[0];\n\n                if (firstField && Array.isArray(fields[firstField])) {\n                  message = fields[firstField][0];\n                }\n              }\n            }\n\n            self.$store.dispatch(\"showNotification\", {\n              statut: true,\n              text: message,\n              color: \"#B71C1C\",\n            });\n          })\n          .finally(() => {\n            self.loading = false;\n          });\n      }\n      /*else {\n               console.log(self.$v);\n             }*/\n    },\n    // Fonction pour récuperer les types de roles dans la store\n    // Fonction pour récuperer le contenu des champs du formulaire\n    getDataForm() {\n      let data = {\n        oldPassword: this.form.oldPassword,\n        re_password: this.form.re_password,\n      };\n      if (!this._.isNull(this.form.password)) {\n        data.password = this.form.password;\n      }\n      if (!this._.isNull(this.form.re_password)) {\n        data.re_password = this.form.re_password;\n      }\n      return data;\n    },\n    setForm(item) {\n      // Données envoyées lors de la modification\n      this.form.id = item.id;\n    },\n  },\n  computed: {\n    // Gestion des erreurs du formulaire\n    roleErrors() {\n      let errors = [];\n      if (!this.$v.form.role.$dirty) return errors;\n      !this.$v.form.role.required &&\n        errors.push(this.$vuetify.lang.t(\"$vuetify.users.cols.role.required\"));\n      return errors;\n    },\n    oldpasswordErrors() {\n      let errors = [];\n      if (!this.$v.form.oldPassword.$dirty) return errors;\n\n      !this.$v.form.oldPassword.required &&\n        errors.push(\n          this.$vuetify.lang.t(\"$vuetify.users.cols.current_password.required\")\n        );\n\n      return errors;\n    },\n    passwordErrors() {\n      let errors = [];\n      if (!this.$v.form.new_password.$dirty) return errors;\n\n      !this.$v.form.new_password.required &&\n        errors.push(\n          this.$vuetify.lang.t(\"$vuetify.users.cols.password.required\")\n        );\n      return errors;\n    },\n    rePasswordErrors() {\n      let errors = [];\n      if (!this.$v.form.re_password.$dirty) return errors;\n\n      !this.$v.form.re_password.sameAsPassword &&\n        errors.push(\n          this.$vuetify.lang.t(\"$vuetify.users.cols.re_password.error\")\n        );\n      return errors;\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--19-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Password.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--19-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Password.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Password.vue?vue&type=template&id=81b7feba&\"\nimport script from \"./Password.vue?vue&type=script&lang=js&\"\nexport * from \"./Password.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VCardTitle,VContainer,VDivider,VForm,VRow,VTextField})\n"],"sourceRoot":""}