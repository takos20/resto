(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf891b12"],{"82c5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"title mb-5 black--text lighten-5 text-center",staticStyle:{height:"30px","margin-top":"30px","background-color":"#e9eef4"}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.compose_preparation.list.title"))+" ")]),i("user",{attrs:{color:"black"}})],1)},a=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-card",{staticClass:"pb-4"},[i("div",{staticClass:"mt-5 mx-5"},[t._.includes(this.$auth.user().permissions,"add_composepreparation")?[i("v-btn",{staticClass:"mr-2 my-2",attrs:{color:"primary",dark:""},on:{click:function(e){return t.create()}}},[i("v-icon",{attrs:{left:""}},[t._v("mdi-content-paste")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.add"))+" ")],1)]:t._e(),i("v-btn",{staticClass:"mr-2 my-2",attrs:{loading:t.loading.refresh,depressed:"",color:"#f1f5fc"},on:{click:function(e){return t.refreshItems()}}},[i("v-icon",{attrs:{left:"",color:"primary"}},[t._v("mdi-refresh")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.refresh"))+" ")],1),i("v-spacer")],2)]),i("br"),i("v-card",{staticClass:"pb-4"},[i("v-card-title",[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.recipe.filter"))+" ")])]),i("v-card-text",[i("v-row",{attrs:{wrap:""}},[i("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"12"}},[i("v-text-field",{attrs:{label:t.$vuetify.lang.t("$vuetify.category.cols.name.title"),"prepend-inner-icon":"mdi-magnify",outlined:"",clearable:"",dense:""},on:{input:function(e){return t.performFilter()}},model:{value:t.filter.name_language,callback:function(e){t.$set(t.filter,"name_language",e)},expression:"filter.name_language"}})],1)],1)],1)],1),i("v-card",[i("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headers,items:t.items,"items-per-page":t.itemPerPage,loading:t.loading.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.dish",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.quantity",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.total_amount",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.created",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.null",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"body",fn:function(e){var s=e.items;return[i("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.hover;return i("tbody",{},t._l(s,(function(e){return i("tr",{key:e.id},[i("td",{staticClass:"subtitle-2"},[t._v(t._s(e.name))]),i("td",{staticClass:"subtitle-2"},[t._v(t._s(e.stock_quantity))]),i("td",{staticClass:"subtitle-2"},[t._v(t._s(e.total_amount))]),i("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]),i("td",{staticClass:"subtitle-2"},[[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"change_composepreparation")?{key:"activator",fn:function(s){var n=s.on;return[i("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||a,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:""},on:{click:function(i){return t.editBills(e)}}},n),[i("v-icon",[t._v("mdi-update")])],1)]}}:null],null,!0)},[i("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"delete_composepreparation")?{key:"activator",fn:function(s){var n=s.on;return[i("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||a,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(i){return t.deleteItem(e)}}},n),[i("v-icon",[t._v("mdi-delete-outline")])],1)]}}:null],null,!0)},[i("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}])}),i("form-bills",{ref:"billsForm",attrs:{dialog:t.dialogForm,form:t.form,messages:t.messages},on:{getItems:t.getItems}}),i("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItems:t.getItems}})],1)],1)},o=[],r=(i("4de4"),i("d3b7"),i("24a2")),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{persistent:"","max-width":"880px",transition:"dialog-bottom-transition"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[i("v-toolbar",{attrs:{dark:"",color:"white",dense:"","max-width":"880px"}},[i("div",{staticClass:"title",staticStyle:{color:"black"}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")]),i("v-spacer"),i("v-btn",{attrs:{icon:"",light:""},on:{click:function(e){return t.forceRefresh()}}},[i("v-icon",[t._v("mdi-close")])],1)],1),i("div",{staticStyle:{"margin-top":"1px"}},[i("v-card",{staticClass:"pb-1"},[i("br"),i("v-form",[i("v-card-text",[i("v-row",{attrs:{wrap:""}},[i("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"6"}},[i("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.recipe.cols.cost.titleT"),outlined:"",value:t.get_bills_amount,readonly:"",filled:"",dense:""}})],1),i("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"6"}}),i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-15px"},attrs:{cols:"12",sm:"6"}},[i("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsComposeIngredient,loading:t.isLoadingCompose,"search-input":t.searchCompose,color:"primary","item-text":"name","item-value":"id",label:t.$vuetify.lang.t("$vuetify.compose_ingredient.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.searchCompose=e},"update:search-input":function(e){t.searchCompose=e}},model:{value:t.form.compose_ingredient,callback:function(e){t.$set(t.form,"compose_ingredient",e)},expression:"form.compose_ingredient"}})],1),i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-15px"},attrs:{cols:"12",sm:"5"}},[i("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.ingredient.cols.stock_quantity.title"),outlined:"",dense:"",type:"number",rules:[t.numberRuleQteServed],min:"0"},model:{value:t.form.stock_quantity,callback:function(e){t.$set(t.form,"stock_quantity",e)},expression:"form.stock_quantity"}})],1),i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-10px"},attrs:{cols:"12",sm:"1"}},[i("v-btn",{attrs:{color:"primary",loading:t.loadingBtn,light:"",dense:"",small:"","max-width":"2px"},on:{click:function(e){return t.savePreparation()}}},[i("v-icon",{attrs:{dark:""}},[t._v(" mdi-content-save ")])],1)],1)],1)],1),i("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-15px"}})],1),i("v-form",{on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}}},[i("br"),i("v-card-text",[i("v-row",{attrs:{wrap:""}},[i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-15px"},attrs:{cols:"12",sm:"8"}},[i("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsIngredient,loading:t.isLoading,"search-input":t.search,color:"primary","item-text":"name","item-value":"id",label:t.$vuetify.lang.t("$vuetify.recipe.cols.ingredient.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e}},model:{value:t.formData.ingredient,callback:function(e){t.$set(t.formData,"ingredient",e)},expression:"formData.ingredient"}})],1),i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-15px"},attrs:{cols:"12",sm:"3"}},[i("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.recipe.cols.quantity.title"),outlined:"",dense:"",type:"number",rules:[t.numberRuleQte],min:"0"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveDetails()}},model:{value:t.formData.quantity,callback:function(e){t.$set(t.formData,"quantity",e)},expression:"formData.quantity"}})],1),i("v-col",{staticClass:"mb-0 py-0",staticStyle:{"margin-top":"-10px"},attrs:{cols:"12",sm:"1"}},[i("v-btn",{attrs:{color:"primary",loading:t.loadingBtn,light:"",dense:"",small:"","max-width":"2px",disabled:null===this.formData.quantity},on:{click:function(e){return t.saveDetails()}}},[i("v-icon",{attrs:{dark:""}},[t._v(" mdi-content-save ")])],1)],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"-30px"},attrs:{color:"primary",light:"",type:"submit",dense:"",loading:t.loadingBtn}},[i("v-icon",[t._v(" mdi-content-save ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.supplies.new.submitSupplies"))+" ")],1)],1),i("v-divider",{staticClass:"mx-4"})],1),i("v-card-text",[i("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headers,items:t.items,"items-per-page":t.itemPerPage,loading:t.loadingDetails.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name","hide-default-footer":""},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.name",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.quantity",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.cost",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"header.null",fn:function(e){var s=e.header;return[i("tr",[t._v(" "+t._s(t.$vuetify.lang.t(s.text))+" ")])]}},{key:"body",fn:function(e){var s=e.items;return[i("tbody",t._l(s,(function(e){return i("tr",{key:e.id},[i("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.ingredient?e.ingredient.name:"-")+" ")]),i("td",{staticClass:"subtitle-2"},[t.editedRowId===e.id?i("div",[i("v-text-field",{staticStyle:{"max-width":"80px"},attrs:{dense:"","hide-details":"",type:"number"},model:{value:t.editedRow.quantity,callback:function(e){t.$set(t.editedRow,"quantity",e)},expression:"editedRow.quantity"}})],1):i("div",[t._v(" "+t._s(e.quantity)+" ")])]),i("td",{staticClass:"subtitle-2"},[t.editedRowId===e.id?i("div",[i("v-text-field",{staticStyle:{"max-width":"80px"},attrs:{dense:"","hide-details":"",type:"number"},model:{value:t.editedRow.cost,callback:function(e){t.$set(t.editedRow,"cost",e)},expression:"editedRow.cost"}})],1):i("div",[t._v(" "+t._s(e.cost)+" ")])]),i("td",{staticClass:"subtitle-2"},[t.editedRowId===e.id?[i("v-btn",{attrs:{icon:"",color:"green"},on:{click:t.saveRowEdit}},[i("v-icon",[t._v("mdi-content-save")])],1),i("v-btn",{attrs:{icon:"",color:"grey"},on:{click:t.cancelRowEdit}},[i("v-icon",[t._v("mdi-cancel")])],1)]:[i("v-btn",{attrs:{icon:"",color:"secondary"},on:{click:function(i){return t.editDetails(e)}}},[i("v-icon",[t._v("mdi-update")])],1),i("v-btn",{attrs:{icon:"",color:"red"},on:{click:function(i){return t.deleteItem(e)}}},[i("v-icon",[t._v("mdi-delete-outline")])],1)]],2)])})),0)]}}])}),i("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsDetails:t.getItemsDetails}})],1)],1),i("form-dish",{attrs:{dialog:t.dialogForm,messages:t.messages}})],1)],1)},u=[],c=(i("c740"),i("4160"),i("a434"),i("b0c0"),i("b680"),i("b64b"),i("159b"),i("5530")),d=i("bcea"),m=i("5ed4"),p=i("6947"),f={mixins:[m["a"]],props:{form:{type:Object,default:function(){return{id:null,compose_ingredient:null,stock_quantity:null}}}},data:function(){return{formData:{id:null,quantity:null},editedRowId:null,editedRow:{},pdfsrc:null,headers:[],headers_act:[],items:[],meta:{},sum:"",loading:{list:!1,refresh:!1,filter:!1},pagination:{},selectedItem:!1,_search:{},_sorts:{},dialogDelete:{show:!1},optionLanguage:{type_language:[]},sortBy:["id"],dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},numberRuleQteServed:function(t){return null===t||""===t||isNaN(t)?"Valeur invalide":!(t<0)||"Entrer un nombre positif"},numberRuleQte:function(t){return null===t||""===t||isNaN(t)?"Valeur invalide":!(t<0)||"Entrer un nombre positif"},messagesDelete:{success:"$vuetify.recipe.delete.success"},loadingBtn:!1,compose_preparations:null,name_language:[],optionsLanguages:{text:{language:"",name:"",saved:!1}},loadingDetails:{list:!1,refresh:!1,filter:!1},loadingPrice:{list:!1,refresh:!1,filter:!1},urlIngredient:"ingredients/all",urlComposeIngredient:"compose_ingredients/all",itemsIngredient:[],itemsComposeIngredient:[],isLoadingCompose:!1,isLoading:!1,search:null,searchCompose:null,itemsDish:[],urlItems:"compose_preparations",itemPerPage:30,itemPerPageOptions:[30,40,50],urlDeleteItems:"",sortDesc:!0,urlItemsDetails_bills:"details_compose_preparations"}},watch:{pagination:{handler:function(){},deep:!0},search:function(t){var e=this;if(null!==t){var i={name_language:t},s=this;this.isLoading=!0,this.$store.dispatch("request",{url:s.urlIngredient,params:i}).then((function(t){s.itemsIngredient=t.data.content})).finally((function(){return e.isLoading=!1}))}},searchCompose:function(t){var e=this;if(null!==t){var i={name_language:t},s=this;this.isLoadingCompose=!0,this.$store.dispatch("request",{url:s.urlComposeIngredient,params:i}).then((function(t){s.itemsComposeIngredient=t.data.content})).finally((function(){return e.isLoadingCompose=!1}))}}},created:function(){this.setHeaders(),this.getOptionsLanguage()},validations:function(){var t={form:{}};return t},methods:{addColumnLanguage:function(){this.name_language.push(Object(c["a"])({},this.optionsLanguages.text))},removeColumnLanguage:function(t){this.name_language.splice(t,1)},forceRefresh:function(){this.dialog.show=!1,this.resetDataForm(),this.resetDataFormProduct()},createEmptySupply:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItems+"/create-empty",method:"POST"}).then((function(i){t.compose_preparations=i.data.id,e(i)}))}))},deleteEmptySupply:function(){var t=this,e=this;return new Promise((function(i){e.$store.dispatch("request",{url:e.urlItems+"/"+t.compose_preparations+"/delete-empty",method:"DELETE"}).then((function(t){i(t)}))}))},editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},deleteItem:function(t){this.urlDeleteItems=this.urlItemsDetails_bills+"/"+t.id,this.dialogDelete.show=!0},getOptionsLanguage:function(){var t=this;this._.each(this.$store.getters.type_language,(function(e){t.optionLanguage.type_language.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},setHeaders:function(){this.headers=[{text:"$vuetify.ingredient.cols.name.title",value:"name",align:"start",sortable:!1,width:"120",class:"grey--text text--darken-3"},{text:"$vuetify.recipe.cols.quantity.title",value:"quantity",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.recipe.cols.cost.title",value:"cost",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.actions.title",value:null,align:"start",sortable:!1,width:"100"}]},getDataFormdetails:function(){var t={compose_preparation:this.compose_preparations,compose_ingredient:this.form.compose_ingredient,quantity:this.formData.quantity,stock_quantity:this.form.stock_quantity,total_amount:parseFloat(this.get_bills_amount||0).toFixed(3),ingredient:this.formData.ingredient};return t},setForm:function(t){this.form.id=t.id,this.compose_preparations=t.id,this.form.stock_quantity=t.stock_quantity,this.form.compose_ingredient=t.compose_ingredient,this.itemsComposeIngredient.push(t.compose_ingredient),this.form.total_amount=t.total_amount,this.getItemsDetails()},getRouteDetails:function(){return this.form.id,this.urlItemsDetails_bills},getDetailsRoute:function(){return this.compose_preparations?this.urlItemsDetails_bills+"?compose_preparation="+this.compose_preparations:this.urlItemsDetails_bills},getMethodDetails:function(){return"POST"},getMethod:function(){return this.form.id?"PUT":"POST"},refreshItemsDetail:function(){var t=this;this.loadingDetails.refresh=!0,this.getItemsDetails().then((function(){})).catch((function(){})).then((function(){t.loadingDetails.refresh=!1}))},getHospital:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsHospital}).then((function(i){var s=i.data;t.tva_collected=s.content[0].VAT_collected,e(i)}))}))},getDataForm:function(){var t={price_per_unit:this.form.price_per_unit,unit:this.form.unit,name_language:this.name_language,stock_quantity:this.form.stock_quantity,compose_ingredient:this.compose_ingredients,compose_preparation:this.compose_preparations,total_amount:parseFloat(this.get_bills_amount||0).toFixed(3),validate:!0};return t},getDataFormPreparation:function(){var t={stock_quantity:this.form.stock_quantity,compose_ingredient:this.form.compose_ingredient,compose_preparation:this.compose_preparations};return t},resetDataForm:function(){this.items=[],this.form.price_per_unit=null,this.form.unit=null,this.name_language=[],this.formData.quantity=null,this.form.stock_quantity=null,this.form.total_amount=null,this.formData.ingredient=null},save:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRoute(),method:e.getMethod(),data:e.getDataForm()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(e.messages.success)}),"PUT"===t.getMethod()?e.$emit("getItems"):(e.$emit("getItems"),e.resetDataForm())})).catch((function(i){var s="$vuetify.error_server";if(i.response&&400===i.response.status){var a=i.response.data;e.setFormErrors(a),t.$forceUpdate();var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(s=a[n][0])}e.$store.dispatch("showNotification",{statut:!0,text:s,color:"#B71C1C"})})).finally((function(){e.loading=!1})))},getItemsDetails:function(){var t=this,e=this,i=this.pagination,s=i.page,a=i.itemsPerPage,n={page:s,size:a};return this._.isEmpty(this._search)||(this._search=this._.merge(n,this._search)),new Promise((function(i,s){t.loadingDetails.list=!0,e.$store.dispatch("request",{url:e.urlItemsDetails_bills+"?compose_ingredient="+t.form.compose_ingredient,params:n}).then((function(s){var a,n,o,r=s.data;e.items=r.content,t.compose_preparations=null===(a=e.items)||void 0===a||null===(n=a[0])||void 0===n||null===(o=n.compose_preparation)||void 0===o?void 0:o["id"],e.meta={totalElements:r.totalElements},i(s)})).catch((function(i){var a=t.$vuetify.lang.t("$vuetify.error_occured");if(i.response)if(400===i.response.status){var n=i.response.data;e.setFormErrors(n);var o=Object.keys(n)[0];o&&Array.isArray(n[o])&&(a=n[o][0])}else 403===i.response.status?a=e.$vuetify.lang.t("$vuetify.error_denied"):500===i.response.status&&(a=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:a}),s(i)})).then((function(){e.loadingDetails.list=!1,i()}))}))},editDetails:function(t){this.editedRowId=t.id,this.editedRow=Object(c["a"])({},t)},saveRowEdit:function(){var t=this;console.log(this.editedRow),this.editedRow.ingredient&&(this.editedRow.ingredient=this.editedRow.ingredient["id"]),this.editedRow.compose_ingredient&&(this.editedRow.compose_ingredient=this.editedRow.compose_ingredient["id"]),this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRouteDetails()+"/"+this.editedRow.id,method:"PATCH",data:this.editedRow}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.resetDataFormProduct()})).catch((function(i){var s;if(i.response)if(400===i.response.status){s="$vuetify.error_occured";var a=i.response.data;e.setFormErrors(a),t.$forceUpdate()}else s="$vuetify.error_server";e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(s),color:"#B71C1C"})})).then((function(){e.loading=!1})));var i=this.items.findIndex((function(e){return e.id===t.editedRow.id}));-1!==i&&this.items.splice(i,1,Object(c["a"])({},this.editedRow)),this.editedRowId=null,this.editedRow={}},cancelRowEdit:function(){this.editedRowId=null,this.editedRow={}},resetDataFormProduct:function(){this.formData.quantity=null,this.formData.ingredient=null},savePreparation:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.urlItemsDetails_bills+"/create",method:e.getMethodDetails(),data:e.getDataFormPreparation()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.resetDataFormProduct()})).catch((function(i){var s;if(i.response)if(400===i.response.status){s="$vuetify.error_occured";var a=i.response.data;e.setFormErrors(a),t.$forceUpdate()}else s="$vuetify.error_server";e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(s),color:"#B71C1C"})})).then((function(){e.loading=!1})))},saveDetails:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRouteDetails(),method:e.getMethodDetails(),data:e.getDataFormdetails()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.resetDataFormProduct()})).catch((function(i){var s;if(i.response)if(400===i.response.status){s="$vuetify.error_occured";var a=i.response.data;e.setFormErrors(a),t.$forceUpdate()}else s="$vuetify.error_server";e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(s),color:"#B71C1C"})})).then((function(){e.loading=!1})))},setFormData:function(t){this.editedRow.pun=t.pun,this.editedRow.pun=this.editedRow.pun-(this.editedRow.pun||0)*(this.editedRow.delivery||0)/100},setFormDataAmount:function(t){this.editedRow.pun=t.pun,this.editedRow.pun=this.editedRow.pun-(this.editedRow.pun||0)*(this.editedRow.delivery||0)/100}},computed:{get_bills_amount:function(){var t=0;return this.items.forEach((function(e){t+=e.cost})),t},nameErrors:function(){var t=[];return this.$v.form.name.$dirty?(!this.$v.form.name.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.name.required")),t):t},reference_noErrors:function(){var t=[];return this.$v.form.reference_no.$dirty?(!this.$v.form.reference_no.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.reference_no.required")),t):t},unitErrors:function(){var t=[];return this.$v.form.unit.$dirty?(!this.$v.form.unit.required&&t.push(this.$vuetify.lang.t("$vuetify.ingredient.cols.unit.required")),t):t},stock_quantityErrors:function(){var t=[];return this.$v.form.stock_quantity.$dirty?(!this.$v.form.stock_quantity.required&&t.push(this.$vuetify.lang.t("$vuetify.ingredient.cols.stock_quantity.required")),t):t},total_amountErrors:function(){var t=[];return this.$v.form.total_amount.$dirty?(!this.$v.form.total_amount.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.total_amount.required")),t):t}},mounted:function(){this.getHospital()},components:{DeleteItem:p["a"],FormDish:d["a"]}},h=f,v=i("2877"),g=i("6544"),y=i.n(g),_=i("c6a6"),$=i("8336"),b=i("b0af"),w=i("99d9"),x=i("62ad"),D=i("8fea"),k=i("169a"),I=i("ce7e"),C=i("4bd4"),q=i("132d"),F=i("0fd9"),R=i("2fa4"),E=i("8654"),V=i("71d9"),P=Object(v["a"])(h,l,u,!1,null,null,null),S=P.exports;y()(P,{VAutocomplete:_["a"],VBtn:$["a"],VCard:b["a"],VCardActions:w["a"],VCardText:w["b"],VCol:x["a"],VDataTable:D["a"],VDialog:k["a"],VDivider:I["a"],VForm:C["a"],VIcon:q["a"],VRow:F["a"],VSpacer:R["a"],VTextField:E["a"],VToolbar:V["a"]});var O=i("cd41"),N={mixins:[r["a"]],data:function(){return{urlItemsCash:"cashs/isOpen",urlItems:"compose_preparations",urlDeleteItems:"compose_preparations",deleteItems:"/compose_preparations",sortBy:["createdAt"],dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormCash:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormInv:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogDelete:{show:!1},isActive:!1,isInventory:!1,dialogDetail:{show:!1},dialogEnt:{show:!1},form:{id:null,patient:null,doctor:null,patient_name:null,patient_balance:null,net_payable:null,patient_type:null,pub:null,pun:null,amount_gross:null,quantity_ordered:null,amount_net:null,total_amount:null,quantity_served:null,product:null,delivery:null,bills:null,reference_no:null,additional_info:null,bills_amount:null,code:null,cashier:null,bill_type:null,amount_paid:null,bill_shape:null,storage_depots:null},filter:{name_language:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.recipe.delete.success"}}},mounted:function(){this.getItems()},methods:{deleteItem:function(t){this.urlDeleteItems=this.deleteItems+"/"+t.id,this.dialogDelete.show=!0},setHeaders:function(){this.headers=[{text:"$vuetify.recipe.cols.dish.title",value:"dish",align:"start",sortable:!0,width:"15",class:"grey--text text--darken-3"},{text:"$vuetify.ingredient.cols.stock_quantity.title",value:"quantity",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"},{text:"$vuetify.recipe.cols.cost.title",value:"total_amount",align:"start",sortable:!0,width:"6",class:"grey--text text--darken-3"},{text:"$vuetify.recipe.cols.created.title",value:"created",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.bills.cols.actions.title",value:null,align:"start",sortable:!0,width:"140"}]},create:function(){this.dialogForm.show=!0,this.messages={title:"$vuetify.compose_preparation.new.title",submit:"$vuetify.compose_preparation.new.submit",success:"$vuetify.compose_preparation.new.success"},this.form={id:null,dish:null,quantity:null}},editBills:function(t){this.dialogForm.show=!0,this.messages={title:"$vuetify.compose_preparation.update.title",submit:"$vuetify.compose_preparation.update.submit",success:"$vuetify.compose_preparation.update.success"},this.$refs.billsForm.setForm(t)},showFilter:function(){this.dialogForm.shows.showFilter=!0},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.name_language&&(e["compose_ingredient_name"]=t.filter.name_language),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))}},components:{FormBills:S,DeleteItem:O["a"]}},T=N,B=i("ce87"),L=i("3a2f"),A=Object(v["a"])(T,n,o,!1,null,"97a54ed2",null),j=A.exports;y()(A,{VBtn:$["a"],VCard:b["a"],VCardText:w["b"],VCardTitle:w["c"],VCol:x["a"],VDataTable:D["a"],VHover:B["a"],VIcon:q["a"],VRow:F["a"],VSpacer:R["a"],VTextField:E["a"],VTooltip:L["a"]});var H={metaInfo:function(){return{title:this.$vuetify.lang.t("$vuetify.compose_preparation.title")}},data:function(){return{}},components:{User:j}},M=H,U=Object(v["a"])(M,s,a,!1,null,null,null);e["default"]=U.exports},cd41:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"300px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[i("v-card",[i("v-card-text",[i("v-divider",{staticClass:"mx-4"}),i("v-card-text",[i("div",{staticClass:"body-1 font-weight-bold"},[i("br"),i("h3",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.delete.confirm"))+" ")])])])],1),i("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-30px"}}),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{disabled:t.loading},on:{click:function(e){t.dialog.show=!1}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.no"))+" ")]),i("v-btn",{attrs:{loading:t.loading,dark:"",color:"#0984e3"},on:{click:function(e){return t.deleteItem()}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.yes"))+" ")])],1)],1)],1)},a=[],n={props:{dialog:{type:Object,default:function(){return{show:!1}}},urlItems:{type:String,default:""},messages:{type:Object,default:function(){return{success:""}}}},data:function(){return{loading:!1}},methods:{deleteItem:function(){var t=this;this.loading=!0,this.$store.dispatch("request",{url:t.urlItems,method:"DELETE",data:t.urlDeleteItems}).then((function(){t.$store.dispatch("showNotification",{statut:!0,text:t.$vuetify.lang.t(t.messages.success)}),t.$emit("getItems"),t.dialog.show=!1})).catch((function(e){console.log("erreur delete",e),t.$store.dispatch("showNotification",{statut:!0,text:t.$vuetify.lang.t("$vuetify.deletedErrors")})})).then((function(){t.loading=!1}))}}},o=n,r=i("2877"),l=i("6544"),u=i.n(l),c=i("8336"),d=i("b0af"),m=i("99d9"),p=i("169a"),f=i("ce7e"),h=i("2fa4"),v=Object(r["a"])(o,s,a,!1,null,null,null);e["a"]=v.exports;u()(v,{VBtn:c["a"],VCard:d["a"],VCardActions:m["a"],VCardText:m["b"],VDialog:p["a"],VDivider:f["a"],VSpacer:h["a"]})}}]);
//# sourceMappingURL=chunk-bf891b12.c24f6c59.js.map