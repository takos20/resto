(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51124343"],{"1c92":function(t,e,s){t.exports=s.p+"img/track.ff703b44.png"},b2a8:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("v-container",{staticClass:"mt-6"},[o("v-row",{attrs:{justify:"center"}},[o("v-col",{attrs:{cols:"12",sm:"10",md:"8"}},[o("div",{staticClass:"text-h6 text-sm-h5 text-md-h4 font-weight-bold green lighten-5 py-3 px-4 text-center rounded"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.storage_depots.title"))+" : "+t._s(t.$route.params.name)+" ")])])],1)],1),o("div",{staticClass:"mt-5 mx-3 mx-sm-5"},[o("v-row",{attrs:{justify:"center"}},[t._.includes(t.$auth.user().permissions,"view_stock_available")?o("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[o("v-btn",{staticClass:"my-2 pa-3",staticStyle:{"font-size":"13px"},attrs:{color:"primary",dark:"",block:"",height:"100"},on:{click:function(e){return t.showAvailable()}}},[o("div",{staticClass:"d-flex flex-column flex-md-row align-center justify-center text-center w-100"},[o("v-list-item-avatar",{staticClass:"mb-2 mb-md-0 mr-0 mr-md-4",attrs:{tile:"",size:"45",dark:""}},[o("v-img",{attrs:{src:s("bb43")}})],1),o("span",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_stocks_available"))+" ")])],1)])],1):t._e(),t._.includes(t.$auth.user().permissions,"view_stock_available")?o("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[o("v-btn",{staticClass:"my-2 pa-3",staticStyle:{"font-size":"13px"},attrs:{color:"primary",dark:"",block:"",height:"100"},on:{click:function(e){return t.showStock_movements()}}},[o("div",{staticClass:"d-flex flex-column flex-md-row align-center justify-center text-center w-100"},[o("v-list-item-avatar",{staticClass:"mb-2 mb-md-0 mr-0 mr-md-4",attrs:{tile:"",size:"45",dark:""}},[o("v-img",{attrs:{src:s("fa0a")}})],1),o("span",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_stocks_movements"))+" ")])],1)])],1):t._e(),t._.includes(t.$auth.user().permissions,"view_inventory")?o("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[o("v-btn",{staticClass:"my-2 pa-3",staticStyle:{"font-size":"13px"},attrs:{color:"primary",dark:"",block:"",height:"100"},on:{click:function(e){return t.showInventory()}}},[o("div",{staticClass:"d-flex flex-column flex-md-row align-center justify-center text-center w-100"},[o("v-list-item-avatar",{staticClass:"mb-2 mb-md-0 mr-0 mr-md-4",attrs:{tile:"",size:"45",dark:""}},[o("v-img",{attrs:{src:s("1c92")}})],1),o("span",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_inventories"))+" ")])],1)])],1):t._e(),t._.includes(t.$auth.user().permissions,"view_items_movements")?o("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[o("v-btn",{staticClass:"my-2 pa-3",staticStyle:{"font-size":"13px"},attrs:{color:"primary",dark:"",block:"",height:"100"},on:{click:function(e){return t.showItemMovements()}}},[o("div",{staticClass:"d-flex flex-column flex-md-row align-center justify-center text-center w-100"},[o("v-list-item-avatar",{staticClass:"mb-2 mb-md-0 mr-0 mr-md-4",attrs:{tile:"",size:"45",dark:""}},[o("v-img",{attrs:{src:s("ceac")}})],1),o("span",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_item_movements"))+" ")])],1)])],1):t._e()],1)],1),t._.includes(this.$auth.user().permissions,"view_stock_available")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showStock_available,expression:"showStock_available"}],staticClass:"title mb-5 black--text lighten-5 text-center",staticStyle:{height:"30px","margin-top":"30px","background-color":"#e9eef4"}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_stocks_available"))+" ")]):t._e(),t._.includes(this.$auth.user().permissions,"view_stock_movement")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.show_stocks_movements,expression:"show_stocks_movements"}],staticClass:"title mb-5 black--text lighten-5 text-center",staticStyle:{height:"30px","margin-top":"30px","background-color":"#e9eef4"}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_stocks_movements"))+" ")]):t._e(),t._.includes(this.$auth.user().permissions,"view_inventory")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showInventories,expression:"showInventories"}],staticClass:"title mb-5 black--text lighten-5 text-center",staticStyle:{height:"30px","margin-top":"30px","background-color":"#e9eef4"}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_inventories"))+" ")]):t._e(),t._.includes(this.$auth.user().permissions,"view_items_movements")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showItem_movements,expression:"showItem_movements"}],staticClass:"title mb-5 black--text lighten-5 text-center",staticStyle:{height:"30px","margin-top":"30px","background-color":"#e9eef4"}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_management.title_item_movements"))+" ")]):t._e(),t._.includes(this.$auth.user().permissions,"view_stock_available")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showStock_available,expression:"showStock_available"}]},[o("form-available",{ref:"form_available",attrs:{color:"black"}})],1):t._e(),t._.includes(this.$auth.user().permissions,"view_stock_movement")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.show_stocks_movements,expression:"show_stocks_movements"}]},[o("form-movement",{ref:"form_movement",attrs:{color:"black"}})],1):t._e(),t._.includes(this.$auth.user().permissions,"view_inventory")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showInventories,expression:"showInventories"}]},[o("form-inventory",{ref:"form_inventory",attrs:{color:"black"}})],1):t._e(),t._.includes(this.$auth.user().permissions,"view_items_movements")?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showItem_movements,expression:"showItem_movements"}]},[o("form-items",{attrs:{color:"black"}})],1):t._e()],1)},i=[],a=(s("4de4"),s("b64b"),s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),s("24a2")),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._.includes(this.$auth.user().permissions,"view_stock_movement")?s("div",[s("v-card",{staticClass:"pb-4"},[s("div",{staticClass:"mt-5 mx-5"},[t._.includes(t.$auth.user().permissions,"add_stock_movement")?[s("v-btn",{staticClass:"mr-2 my-2",attrs:{color:"primary",dark:""},on:{click:function(e){return t.create_movement()}}},[s("v-icon",[t._v(" mdi-plus ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.add"))+" ")],1)]:t._e(),s("v-btn",{staticClass:"mr-2 my-2",attrs:{loading:t.loadingStockMovement.refresh,depressed:"",color:"#f1f5fc"},on:{click:function(e){return t.refresh_stock_movement()}}},[s("v-icon",{attrs:{left:"",color:"primary"}},[t._v("mdi-refresh")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.refresh"))+" ")],1),s("v-spacer")],2)]),s("br"),s("v-card",{staticClass:"pb-4"},[s("v-card-title",[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.filter"))+" ")])]),s("v-card-text",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"12"}},[s("v-select",{staticClass:"font-weight-bold",attrs:{color:"primary",items:t.optionMovement.type_Movement,label:t.$vuetify.lang.t("$vuetify.cash_movement.cols.type.title"),dense:"","prepend-inner-icon":"mdi-account-supervisor-circle",outlined:"",clearable:""},on:{change:t.performFilterMovement},model:{value:t.filter.type_movement,callback:function(e){t.$set(t.filter,"type_movement",e)},expression:"filter.type_movement"}})],1)],1)],1)],1),s("v-card",[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headersStock_movement,items:t.itemsStock_movement,"items-per-page":t.itemPerPage,loading:t.loading.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.date_movement",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.type_movement",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.reason_movement",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.product_code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.movement_value",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.is_valid",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.create_date",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"subtitle-2"},[t._v(t._s(e.code))]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]),s("td",{staticClass:"subtitle-2"},[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u(["ENTRY"===e.type_movement?{key:"activator",fn:function(o){var i=o.on;return[s("v-icon",t._g({staticClass:"pointer",staticStyle:{"font-size":"15px"},attrs:{color:"teal darken-1",dark:""}},i),[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.cash_movement.cols.type."+e.type_movement))+" ")])]}}:"TRANSFER"===e.type_movement?{key:"activator",fn:function(o){var i=o.on;return[s("v-icon",t._g({staticClass:"pointer",staticStyle:{"font-size":"15px"},attrs:{color:"green darken-1",dark:""}},i),[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.cash_movement.cols.type."+e.type_movement))+" ")])]}}:{key:"activator",fn:function(o){var i=o.on;return[s("v-icon",t._g({staticClass:"pointer",staticStyle:{"font-size":"15px"},attrs:{color:"red accent-4",dark:""}},i),[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.cash_movement.cols.type."+e.type_movement))+" ")])]}}],null,!0)})],1),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.reason_movement)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.product_code)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.movement_value)+" ")]),s("td",[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(o){var i=o.on;return[e.is_valid?[s("v-icon",t._g({staticClass:"pointer",attrs:{color:"primary",dark:""}},i),[t._v(" mdi-check-circle ")])]:[s("v-icon",t._g({staticClass:"pointer",attrs:{color:"red accent-4",dark:"",disabled:"TRANSFER"!==e.type_movement},on:{click:function(s){return t.enabled(e)}}},i),[t._v(" mdi-close-circle ")])]]}}],null,!0)},[e.is_valid?t._e():s("span",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.cols.is_valid.enabled"))+" ")])])],1),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]),s("td",{staticClass:"subtitle-2"},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"change_stock_movement")?{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:""},on:{click:function(s){return t.editStock_movement(e)}}},a),[s("v-icon",[t._v("mdi-update")])],1)]}}:null],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"view_complaints")?{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"btn_logout",icon:"",text:""},on:{click:function(s){return t.viewComplaints(e)}}},a),[s("v-icon",[t._v("mdi-note-text")])],1)]}}:null],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.complaints.title")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"delete_stock_movement")?{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",[t._v("mdi-delete-outline")])],1)]}}:null],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}],null,!1,1570552333)}),s("form-complaints",{ref:"complaintsForm",attrs:{dialog:t.dialogFormComplaints,form:t.form,messages:t.messages},on:{getItems:t.getItems}}),s("form-movement",{ref:"stock_movementForm",attrs:{dialog:t.dialogFormStock_movement,form:t.form,messages:t.messages},on:{getItems:t.get_stock_movement}}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItems:t.getItems}}),s("form-inv",{ref:"invForm",attrs:{dialog:t.dialogFormInv}}),s("form-enable",{ref:"enableUser",attrs:{dialog:t.dialogForm,messages:t.messages},on:{getItems:t.get_stock_movement}})],1)],1):t._e()])},r=[],l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{"max-width":"300"},model:{value:t.dialog.shows.showInfo,callback:function(e){t.$set(t.dialog.shows,"showInfo",e)},expression:"dialog.shows.showInfo"}},[s("v-card",[s("v-card-text",[s("div",{staticClass:"body-1 font-weight-bold"},[s("br"),s("h3",[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")])])]),s("v-divider"),s("v-card-actions",[s("v-spacer"),s("v-btn",{on:{click:function(e){t.dialog.shows.showInfo=!1}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.close"))+" ")]),s("v-btn",{attrs:{color:"#0984e3",loading:t.loading,dark:"",type:"submit"},on:{click:t.send}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.submit))+" ")])],1)],1)],1)},u=[],c=s("5ed4"),m={mixins:[c["a"]],name:"Infos",props:{dialog:{type:Object,default:function(){return{shows:{showInfo:!1}}}},form:{type:Object,default:function(){return{id:null,stock_movement:null,total_amount:null,storage_depots_dest:null,quantity:null,details_stock:null,is_valid:null,product_code:null,date_movement:(new Date).toISOString().substr(0,10),type_movement:null,reason_movement:"RAS",movement_value:null,code:null,storage_depots:null}}}},data:function(){return{loading:!1,urlItems:"stock_movements",itemsRole:[]}},methods:{setForm:function(t){this.form.id=t.id,this.form.stock_movement=t.id,this.form.type_movement=t.type_movement,this.form.date_movement=t.createdAt,this.form.movement_value=t.movement_value,this.form.reason_movement=t.reason_movement,this.form.is_valid=!t.is_valid,this.form.storage_depots=null===t.storage_depots?"":t.storage_depots["id"],this.form.code=t.code},getRoute:function(){return this.form.id?this.urlItems+"/"+this.form.id:this.urlItems},send:function(){this.$store.dispatch("setNotification",{status:!1});var t=this;this.loading=!0,this.$store.dispatch("request",{url:t.getRoute(),method:"PATCH",data:t.getDataForm()}).then((function(){t.$store.dispatch("setNotification",{status:!0,message:t.$vuetify.lang.t(t.messages.success)}),t.$emit("getItems")})).catch((function(e){console.log("error",e);var s="$vuetify.error_occured";t.$store.dispatch("setNotification",{status:!0,message:t.$vuetify.lang.t(s)})})).then((function(){t.loading=!1}))}}},d=m,v=s("2877"),f=s("6544"),h=s.n(f),p=s("8336"),_=s("b0af"),y=s("99d9"),g=s("169a"),b=s("ce7e"),$=s("2fa4"),k=Object(v["a"])(d,l,u,!1,null,null,null),w=k.exports;h()(k,{VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VDialog:g["a"],VDivider:b["a"],VSpacer:$["a"]});var x=s("cd41"),D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{persistent:"","max-width":"1100px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",color:"#f5f5f5",dense:""}},[s("div",{staticClass:"title",staticStyle:{color:"black"}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")]),s("v-spacer"),s("v-btn",{attrs:{icon:"",light:""},on:{click:function(e){t.forceRefresh(),t.resetDataForm()}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-form",[s("v-card-text",{staticClass:"mt-2"},[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.stock_movement.cols.code.title"),"prepend-inner-icon":"mdi-code-array",outlined:"",dense:"",filled:"",readonly:""},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.stock_movement.cols.date_movement.title"),"prepend-inner-icon":"mdi-clock-start",outlined:"",dense:"",filled:"",readonly:""},model:{value:t.form.date_movement,callback:function(e){t.$set(t.form,"date_movement",e)},expression:"form.date_movement"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-select",{staticClass:"font-weight-bold",attrs:{color:"primary",items:t.optionMovement.type_Movement,label:t.$vuetify.lang.t("$vuetify.cash_movement.cols.type.title"),dense:"",disabled:t.form.id,"error-messages":t.type_movementErrors,"prepend-inner-icon":"mdi-account-supervisor-circle",outlined:""},on:{blur:function(e){return t.$v.form.type_movement.$touch()},input:function(e){return t.$v.form.type_movement.$touch()}},model:{value:t.form.type_movement,callback:function(e){t.$set(t.form,"type_movement",e)},expression:"form.type_movement"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.stock_movement.cols.reason_movement.title"),"prepend-inner-icon":"mdi-script-text",outlined:"",disabled:t.form.id,"error-messages":t.reason_movementErrors,dense:"",readonly:t.supply},on:{blur:function(e){return t.$v.form.reason_movement.$touch()},input:function(e){return t.$v.form.reason_movement.$touch()}},model:{value:t.form.reason_movement,callback:function(e){t.$set(t.form,"reason_movement",e)},expression:"form.reason_movement"}})],1)],1)],1),s("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-15px"}})],1),s("v-form",{staticStyle:{"margin-top":"-5px"},on:{submit:function(e){return e.preventDefault(),t.saveDetails.apply(null,arguments)}}},[s("v-card-text",{staticClass:"mt-3"},[t.form&&"TRANSFER"===t.form.type_movement?s("v-card",{staticClass:"pa-4 mb-4",attrs:{outlined:"",elevation:"3"}},[s("div",{staticClass:"d-flex align-center"},[s("v-avatar",{staticClass:"mr-4",attrs:{color:"red lighten-4",size:"48"}},[s("v-icon",{attrs:{color:"red darken-2"}},[t._v(" mdi-swap-horizontal ")])],1),s("div",[s("div",{staticClass:"subtitle-1 font-weight-bold red--text"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.transfer"))+" ")]),s("div",{staticClass:"caption grey--text"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.transfer_info"))+" ")])])],1)]):t._e(),s("br"),s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"6"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsProduct,loading:t.isLoading,"search-input":t.search,color:"primary","item-text":"product_name","item-value":"id","return-object":"",disabled:t.form.id,label:t.$vuetify.lang.t("$vuetify.ingredient.title"),"prepend-inner-icon":"mdi-rename-box",outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e},change:t.onIngredientSelect},scopedSlots:t._u([{key:"selection",fn:function(e){return[t._v(" "+t._s(e.item.ingredient.name)+" - "+t._s(e.item.quantity)+" ")]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.ingredient.name)+" - "+t._s(e.item.quantity)+" ")]}},{key:"label",fn:function(){return[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.ingredient.title"))+" ")]},proxy:!0}]),model:{value:t.form.details_stock,callback:function(e){t.$set(t.form,"details_stock",e)},expression:"form.details_stock"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.stock_movement.cols.quantity.titleTransfer"),"prepend-inner-icon":"mdi-numeric-0-box",outlined:"",disabled:t.form.id,dense:"",type:"number",min:"0",rules:[t.numberRule]},model:{value:t.form.quantity,callback:function(e){t.$set(t.form,"quantity",e)},expression:"form.quantity"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsDepot,loading:t.isLoadingDepot,"search-input":t.searchDepot,color:"primary","item-text":"name","item-value":"id",label:t.$vuetify.lang.t("$vuetify.stock_movement.cols.depot.title"),"prepend-inner-icon":"mdi-archive mdi-dark mdi-18px",outlined:"",dense:"",disabled:"TRANSFER"!==this.form.type_movement||t.form.id,clearable:"",readonly:t.supply},on:{"update:searchInput":function(e){t.searchDepot=e},"update:search-input":function(e){t.searchDepot=e}},model:{value:t.form.storage_depots_dest,callback:function(e){t.$set(t.form,"storage_depots_dest",e)},expression:"form.storage_depots_dest"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"1"}},[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[s("v-btn",t._g({staticStyle:{"margin-top":"3px"},attrs:{color:"primary",loading:t.loadingBtn,ligt:"",type:"submit",dense:"",small:"","max-width":"2px",disabled:null===t.form.type_movement||null===t.form.reason_movement||null===t.form.quantity||t.form.id}},o),[s("v-icon",{attrs:{dark:""}},[t._v(" mdi-content-save ")])],1)]}}])},[s("span",{staticClass:"text-center font-weight-bold body-2 withe--text text--d ken-1"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.bills.new.add_product"))+" ")])])],1)],1)],1)],1),s("v-card-actions",{staticStyle:{"margin-top":"-28px"}},[s("v-spacer"),s("v-btn",{staticClass:"mr-2",attrs:{color:"primary",depressed:"",dense:"",ligt:"",loading:t.loadingBtn,disabled:null===t.form.type_movement||null===t.form.reason_movement||t.form.id},on:{click:function(e){return t.save()}}},[s("v-icon",[t._v(" mdi-content-save ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.new.submitstock_movement"))+" ")],1)],1),s("v-divider",{staticClass:"mx-4"}),s("v-card-text",[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headers,items:t.items,"items-per-page":t.itemPerPage,loading:t.loadingDetails.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.product_name",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.storage_depots_dest",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.ingredient.name)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity)+" ")]),e.storage_depots_dest?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.storage_depots_dest.name)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("R.A.S")]),s("td",{staticClass:"subtitle-2",attrs:{width:"50px"}},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:"",light:"",disabled:this.form.id},on:{click:function(s){return t.editDetails(e)}}},a),[s("v-icon",{attrs:{"mdi-18px":""}},[t._v("mdi-grease-pencil")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",disabled:this.form.id,dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",{attrs:{"mdi-18px":""}},[t._v("mdi-delete-outline")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}])}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsDetails:t.getItemsDetails}})],1)],1)],1)},I=[],C=(s("4160"),s("fb6a"),s("b0c0"),s("159b"),s("53ca")),F=(s("96cf"),s("1da1")),S=s("b5ae"),E=s("6947"),P={mixins:[c["a"]],props:{form:{type:Object,default:function(){return{id:null,stock_movement:null,total_amount:null,storage_depots_dest:null,quantity:null,details_stock:null,product_code:null,date_movement:(new Date).toISOString().substr(0,10),type_movement:null,reason_movement:"RAS",movement_value:null,code:null,storage_depots:null}}}},data:function(){return{formData:{id:null,name:null,coefficient:null,number_account:null,quote_internal:null,quote_external:null},numberRule:function(t){return!(t<0)||"Entrer un nombre positif"},headers:[],items:[],meta:{},isLoadingDepot:!1,searchDepot:null,itemsDepot:[],urlDepot:"storage_depots",itemPerPage:10,itemPerPageOptions:[5,10,30],urlDeleteItems:"",sortDesc:!0,loading:{list:!1,refresh:!1,filter:!1},pagination:{},selectedItem:!1,_search:{},_sorts:{},dialogDelete:{show:!1},sortBy:["id"],e1:1,isLoading:!1,search:null,menu2:!1,supply:!1,active:!1,menu3:!1,menu4:!1,stock_movements:null,menu:!1,dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormDetails:{show:!1,shows:{showFilter:!1,showInfo:!1}},minDate:(new Date).toISOString().substr(0,10),messagesDelete:{success:"$vuetify.stock_movement.delete.success"},loadingBtn:!1,loadingDetails:{list:!1,refresh:!1,filter:!1},optionMovement:{type_Movement:[]},itemsProduct:[],urlItemsMov:"details_stock_movement/noneMov",urlProduct:"details_stocks/specify",urlItems:"stock_movements",urlItemsDetails_stock_movement:"details_stock_movement"}},watch:{"dialog.show":{immediate:!1,handler:function(t){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!t){s.next=7;break}if(e.form.id){s.next=4;break}return s.next=4,e.createEmptySupply();case 4:return s.next=6,e.getItemsDetails();case 6:e.form.date_movement=(new Date).toISOString().slice(0,10);case 7:if(t){s.next=10;break}return s.next=10,e.deleteEmptySupply();case 10:case"end":return s.stop()}}),s)})))()}},pagination:{handler:function(){this.getItemsDetails()},deep:!0},searchDepot:function(t){var e=this;if(null!==t){var s={name_language:t},o=this;this.isLoadingDepot=!0,this.$store.dispatch("request",{url:o.urlDepot,params:s}).then((function(t){o.itemsDepot=t.data.content})).finally((function(){return e.isLoadingDepot=!1}))}},search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProduct+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}}},created:function(){this.setHeaders(),this.getOptionsMovement()},validations:function(){var t={form:{type_movement:{required:S["required"]},reason_movement:{required:S["required"]}}};return t},methods:{onIngredientSelect:function(t){t&&t.ingredient?(this.form.details_stock=t.ingredient.id,this.form.ingredient_name=t.ingredient.name):(this.form.details_stock=null,this.form.ingredient_name=null)},createEmptySupply:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:"stock_movements/create-empty",method:"POST"}).then((function(s){t.stock_movements=s.data.id,e(s)}))}))},deleteEmptySupply:function(){var t=this,e=this;return new Promise((function(s){e.$store.dispatch("request",{url:"stock_movements/"+t.stock_movements+"/delete-empty",method:"DELETE"}).then((function(t){s(t)}))}))},getOptionsMovement:function(){var t=this;this._.each(this.$store.getters.type_Movement_stock,(function(e){t.optionMovement.type_Movement.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},forceRefresh:function(){this.dialog.show=!1,this.items=[],this.active=!1,this.resetDataForm(),this.getNoneMov()},deleteItem:function(t){this.urlDeleteItems=this.urlItemsDetails_stock_movement+"/"+t.id,this.dialogDelete.show=!0},setHeaders:function(){this.headers=[{text:"$vuetify.ingredient.title",value:"product_name",align:"start",sortable:!1,width:"150",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity.titleTransfer",value:"quantity",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.depot.title",value:"storage_depots_dest",align:"start",sortable:!1,width:"30",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.actions.title",value:null,align:"start",sortable:!1,width:"70"}]},createD:function(){this.dialogForm.show=!0,this.formData={id:null,name:null,coefficient:null,number_account:null,quote_internal:null,quote_external:null}},getDataForm:function(){var t={createdAt:this.form.date_movement,stock_movement:this.stock_movements,type_movement:this.form.type_movement,suppliers:this.form.suppliers,reason_movement:this.form.reason_movement,movement_value:this.get_movement_value,storage_depots:this.$route.params.id};return t},getDataFormdetails:function(){var t={ingredient:this.form.details_stock,stock_movement:this.stock_movements,quantity:this.form.quantity,type_movement:this.form.type_movement,storage_depots_dest:this.form.storage_depots_dest,storage_depots:this.$route.params.id,createdAt:this.form.date_movement};return t},setForm:function(t){this.form.id=t.id,this.stock_movements=t.id,this.form.type_movement=t.type_movement,this.form.date_movement=t.createdAt,this.form.movement_value=t.movement_value,this.form.reason_movement=t.reason_movement,this.form.code=t.code,this.getItemsDetails()},getRouteDetails:function(){return this.form.id?this.urlItemsDetails_stock_movement+"/"+this.form.id:this.urlItemsDetails_stock_movement},getRoute:function(){return this.form.id?this.urlItems+"/"+this.form.id:this.urlItems},resetDataFormProduct:function(){this.form.details_stock=null,this.form.quantity=null},resetDataForm:function(){if(this.form.product=null,this.form.id=null,this.form.type_movement=null,this.items=[],!this.form.id){var t=this;this.$v.form.$reset(),this._.each(this.form,(function(e,s){"object"===Object(C["a"])(t.form[s])?t._.each(t.form[s],(function(e,o){"boolean"===typeof t.form[s][o]?t.form[s][o]=!1:t.form[s][o]=null})):"boolean"===typeof t.form[s]?t.form[s]=!1:t.form[s]=null}))}},refreshItemsDetail:function(){var t=this;this.loadingDetails.refresh=!0,this.getItemsDetails().then((function(){})).catch((function(){})).then((function(){t.loadingDetails.refresh=!1}))},editDetails:function(t){this.form.details_stock=t.ingredient},save:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRoute(),method:e.getMethod(),data:e.getDataForm()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.stock_movement.new.success")}),e.$emit("getStockMovement"),e.resetDataForm(),t.createEmptySupply()})).catch((function(s){var o="$vuetify.error_server";if(s.response&&400===s.response.status){var i=s.response.data;e.setFormErrors(i),t.$forceUpdate();var a=Object.keys(i)[0];a&&Array.isArray(i[a])&&(o=i[a][0])}e.$store.dispatch("showNotification",{statut:!0,text:o,color:"#B71C1C"})})).finally((function(){e.loading=!1})))},getItemsDetails:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingDetails.list=!0,e.$store.dispatch("request",{url:e.urlItemsDetails_stock_movement+"?stock_movement="+t.stock_movements,params:a}).then((function(t){var o=t.data;e.items=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingDetails.list=!1,s()}))}))},saveDetails:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRouteDetails(),method:e.getMethod(),data:e.getDataFormdetails()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.form.details_stock=null,e.form.quantity=null,e.form.storage_depots=null,e.form.storage_depots_dest=null})).catch((function(s){var o="$vuetify.error_server";if(s.response&&400===s.response.status){var i=s.response.data;e.setFormErrors(i),t.$forceUpdate();var a=Object.keys(i)[0];a&&Array.isArray(i[a])&&(o=i[a][0])}e.$store.dispatch("showNotification",{statut:!0,text:o,color:"#B71C1C"})})).finally((function(){e.loading=!1})))},getNoneMov:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsMov}).then((function(t){e(t)}))}))}},computed:{get_product_code:function(){var t,e,s,o="";o=null===this.form.details_stock?"":null===(t=this.form.details_stock)||void 0===t||null===(e=t.product)||void 0===e?void 0:e.code;var i="";i=null===this.form.details_stock||void 0===this.form.details_stock?"":null===(s=this.form.details_stock)||void 0===s?void 0:s.qte_stock;var a="";return a=o+"  /  "+i,a},get_product_stock:function(){var t,e="";return e=null===this.form.details_stock?0:null===(t=this.form.details_stock)||void 0===t?void 0:t.qte_stock,e},get_movement_value:function(){var t=0;return this.items.forEach((function(e){t+=e.total_amount})),t},reason_movementErrors:function(){var t=[];return this.$v.form.reason_movement.$dirty?(!this.$v.form.reason_movement.required&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.reason_movement.required")),t):t},product_codeErrors:function(){var t=[];return this.$v.form.product_code.$dirty?(!this.$v.form.product_code.product_code&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.product_code.invalid")),!this.$v.form.product_code.unique&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.product_code.unique")),t):t},type_movementErrors:function(){var t=[];return this.$v.form.type_movement.$dirty?(!this.$v.form.type_movement.required&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.type_movement.required")),t):t},date_movementErrors:function(){var t=[];return this.$v.form.date_movement.$dirty?(!this.$v.form.date_movement.required&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.date_movement.required")),t):t},operation_dateErrors:function(){var t=[];return this.$v.form.operation_date.$dirty?(!this.$v.form.operation_date.required&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.birthday.required")),t):t},total_amountErrors:function(){var t=[];return this.$v.form.total_amount.$dirty?(!this.$v.form.total_amount.required&&t.push(this.$vuetify.lang.t("$vuetify.stock_movement.cols.total_amount.required")),t):t}},mounted:function(){this.getNoneMov(),window.addEventListener("keydown",(function(t){(t.metaKey||t.ctrlKey)&&t.keyCode==="r".charCodeAt(0)&&(t.preventDefault(),this.resetFormBills())}))},components:{DeleteItem:E["a"]}},q=P,A=s("c6a6"),V=s("8212"),M=s("62ad"),O=s("8fea"),B=s("4bd4"),T=s("ce87"),j=s("132d"),N=s("0fd9"),R=s("b974"),L=s("8654"),H=s("71d9"),U=s("3a2f"),Y=Object(v["a"])(q,D,I,!1,null,null,null),z=Y.exports;h()(Y,{VAutocomplete:A["a"],VAvatar:V["a"],VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCol:M["a"],VDataTable:O["a"],VDialog:g["a"],VDivider:b["a"],VForm:B["a"],VHover:T["a"],VIcon:j["a"],VRow:N["a"],VSelect:R["a"],VSpacer:$["a"],VTextField:L["a"],VToolbar:H["a"],VTooltip:U["a"]});var Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{persistent:"","max-width":"1100px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",color:"#f5f5f5",dense:""}},[s("div",{staticClass:"title",staticStyle:{color:"black"}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")]),s("v-spacer"),s("v-btn",{attrs:{icon:"",light:""},on:{click:function(e){t.forceRefresh(),t.resetDataForm()}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-card",[s("br"),s("v-form",[s("v-card-text",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.supplies.cols.code.title"),"prepend-inner-icon":"mdi-code-array mdi-dark mdi-18px",outlined:"",dense:"",filled:"",readonly:""},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.complaints.cols.date.title"),"prepend-inner-icon":"mdi-calendar mdi-dark mdi-18px",outlined:"",dense:"",readonly:"",filled:""},model:{value:t.form.complaints_date,callback:function(e){t.$set(t.form,"complaints_date",e)},expression:"form.complaints_date"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.complaints.cols.responsible.title"),"prepend-inner-icon":"mdi-account mdi-dark mdi-18px",outlined:"",dense:""},model:{value:t.form.responsible,callback:function(e){t.$set(t.form,"responsible",e)},expression:"form.responsible"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.complaints.cols.witnesses.title"),"prepend-inner-icon":"mdi-account-multiple mdi-dark mdi-18px",outlined:"",dense:""},model:{value:t.form.witnesses,callback:function(e){t.$set(t.form,"witnesses",e)},expression:"form.witnesses"}})],1)],1)],1),s("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-10px"}})],1),s("v-form",{staticStyle:{"margin-top":"10px"},on:{submit:function(e){return e.preventDefault(),t.saveDetails.apply(null,arguments)}}},[s("v-card-text",[s("v-row",{attrs:{wrap:""}},["laboratory"===this.$route.params.idD?s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-select",{staticClass:"font-weight-bold",attrs:{color:"primary",items:t.optionType.type_product,label:t.$vuetify.lang.t("$vuetify.supplies.cols.type_product.title"),placeholder:t.$vuetify.lang.t("$vuetify.supplies.cols.type_product.title"),"prepend-inner-icon":"mdi-gender-male-female mdi-dark mdi-18px",outlined:"",dense:""},scopedSlots:t._u([{key:"label",fn:function(){return[s("span",{staticClass:"red--text"},[s("strong",[t._v("* ")])]),t._v(t._s(t.$vuetify.lang.t("$vuetify.supplies.cols.type_product.title"))+" ")]},proxy:!0}],null,!1,1815843071),model:{value:t.formData.type_product,callback:function(e){t.$set(t.formData,"type_product",e)},expression:"formData.type_product"}})],1):t._e(),"pharmacy"===this.$route.params.idD?s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsProduct,loading:t.isLoading,"search-input":t.search,color:"primary","item-text":"name","item-value":"id","return-object":"",label:t.$vuetify.lang.t("$vuetify.supplies.cols.product_name.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e}},model:{value:t.formData.product,callback:function(e){t.$set(t.formData,"product",e)},expression:"formData.product"}})],1):t._e(),"laboratory"===this.$route.params.idD&&"REAGENT"===this.formData.type_product?s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsReagent,loading:t.isLoadingReagent,"search-input":t.searchReagent,color:"primary","item-text":"name","item-value":"id","return-object":"",label:t.$vuetify.lang.t("$vuetify.reagent.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.searchReagent=e},"update:search-input":function(e){t.searchReagent=e}},model:{value:t.formData.reagent,callback:function(e){t.$set(t.formData,"reagent",e)},expression:"formData.reagent"}})],1):t._e(),"laboratory"===this.$route.params.idD&&"CONSUMABLE"===this.formData.type_product?s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsConsumable,loading:t.isLoadingConsumable,"search-input":t.searchConsumable,color:"primary","item-text":"name","item-value":"id","return-object":"",label:t.$vuetify.lang.t("$vuetify.consumable.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.searchConsumable=e},"update:search-input":function(e){t.searchConsumable=e}},model:{value:t.formData.consumable,callback:function(e){t.$set(t.formData,"consumable",e)},expression:"formData.consumable"}})],1):t._e(),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.supplies.cols.product_code.title"),outlined:"",dense:"",readonly:"",filled:""},model:{value:t.get_product_code,callback:function(e){t.get_product_code=e},expression:"get_product_code"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-select",{staticClass:"font-weight-bold",attrs:{color:"primary",items:t.optionAnomaly.type_anomaly,label:t.$vuetify.lang.t("$vuetify.complaints.cols.anomaly.title"),placeholder:t.$vuetify.lang.t("$vuetify.complaints.cols.anomaly.title"),outlined:"",dense:""},scopedSlots:t._u([{key:"label",fn:function(){return[s("span",{staticClass:"red--text"},[s("strong",[t._v("* ")])]),t._v(t._s(t.$vuetify.lang.t("$vuetify.complaints.cols.anomaly.title"))+" ")]},proxy:!0}]),model:{value:t.formData.type_anomaly,callback:function(e){t.$set(t.formData,"type_anomaly",e)},expression:"formData.type_anomaly"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"1"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.supplies.cols.quantity.title"),outlined:"",dense:"",type:"number",min:"0",readonly:null!==this.form.id,rules:[t.numberRule]},model:{value:t.formData.quantity,callback:function(e){t.$set(t.formData,"quantity",e)},expression:"formData.quantity"}})],1),"OTHER_ANOMALY"===this.formData.type_anomaly?s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-textarea",{staticClass:"font-weight-bold",attrs:{dense:"",rows:2,outlined:"",label:t.$vuetify.lang.t("$vuetify.complaints.cols.other_anomaly.title"),color:"primary"},model:{value:t.formData.other_anomaly,callback:function(e){t.$set(t.formData,"other_anomaly",e)},expression:"formData.other_anomaly"}})],1):t._e(),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"1"}},[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[[s("v-btn",t._g({staticStyle:{"margin-top":"3px"},attrs:{color:"primary",loading:t.loadingBtn,dark:"",type:"submit",dense:"","max-width":"2px"}},o),[s("v-icon",{attrs:{dark:""}},[t._v(" mdi-content-save ")])],1)]]}}])},[s("span",{staticClass:"text-center font-weight-bold body-2 withe--text text--d ken-1"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.bills.new.add_product"))+" ")])])],1)],1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"-30px"},attrs:{loading:t.loading.refresh,depressed:"",color:"#f1f5fc"},on:{click:function(e){return t.refreshItemsDetail()}}},[s("v-icon",{attrs:{left:"",color:"primary"}},[t._v("mdi-refresh")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.refresh"))+" ")],1),s("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"-30px"},attrs:{color:"primary",dark:"",loading:t.loadingBtn,disabled:null===t.form.suppliers||0===t.get_complaints_amount},on:{click:function(e){return t.save_print_bills()}}},[s("v-icon",[t._v(" mdi-content-save ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.save"))+" ")],1)],1),s("v-divider",{staticClass:"mx-4"})],1),s("v-card-text",[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headers,items:t.items,"items-per-page":t.itemPerPage,loading:t.loadingDetails.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.product_name",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.product_code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.type_anomaly",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.other_anomaly",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.product?e.product.name:e.reagent?e.reagent.name:e.consumable?e.consumable.name:"-")+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.product?e.product.code:e.reagent?e.reagent.code:e.consumable?e.consumable.code:"-")+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.type_anomaly?t.$vuetify.lang.t("$vuetify.complaints.cols.anomaly."+e.type_anomaly):"-")+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.other_anomaly?e.other_anomaly:"-")+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity)+" ")]),s("td",{staticClass:"subtitle-2",attrs:{width:"50px"}},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"change_detailscomplaints")?{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:""},on:{click:function(s){return t.editDetails(e)}}},a),[s("v-icon",[t._v("mdi-grease-pencil")])],1)]}}:null],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t._.includes(t.$auth.user().permissions,"delete_detailscomplaints")?{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",[t._v("mdi-delete-outline")])],1)]}}:null],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}])}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsDetails:t.getItemsDetails}}),s("form-details",{ref:"detailsForm",attrs:{dialog:t.dialogFormDetails,form:t.form,messages:t.messages},on:{getItems:t.getItemsDetails}})],1)],1),s("form-product",{attrs:{dialog:t.dialogForm,messages:t.messages}}),s("form-suppliers",{attrs:{dialog:t.dialogFormSupplies,messages:t.messages}})],1)],1)},K=[],W=s("ae8a"),G=s("6616"),J=s("c6cdb"),X=s("21a6"),Z={mixins:[c["a"]],props:{form:{type:Object,default:function(){return{id:null,quantity:null,product:null,complaints_date:null,responsible:null,witnesses:null,purchase_order:null,is_received:null,code:null}}}},data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{id:null,quantity:null,product:null,type_product:null,consumable:null,reagent:null,other_anomaly:null,type_anomaly:null,purchase_order:null,complaints:null,is_received:null,code:null},isInventory:!1,urlItemsNonePurchase:"details_purchase_orders/nonePurchase",headers:[],items:[],numberRule:function(t){return!(t<0)||"Entrer un nombre positif"},numberRuleArrivalPrice:function(t){return!(t<0)||"Entrer un nombre positif"},meta:{},itemPerPage:10,itemPerPageOptions:[5,10,30],urlDeleteItems:"",sortDesc:!0,loading:{list:!1,refresh:!1,filter:!1},pagination:{},selectedItem:!1,_search:{},_sorts:{},dialogDelete:{show:!1},sortBy:["id"],e1:1,menu2:!1,supply:!1,active:!1,menu3:!1,menu4:!1,menu:!1,dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormSupplies:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormDetails:{show:!1,shows:{showFilter:!1,showInfo:!1}},messagesDelete:{success:"$vuetify.purchase.delete.success"},loadingBtn:!1,loadingDetails:{list:!1,refresh:!1,filter:!1},itemsProduct:[],isLoading:!1,search:null,optionType:{type_product:[]},optionAnomaly:{type_anomaly:[]},urlProduct:"products",urlSuppliers:"suppliers",itemsSuppliers:[],searchSuppliers:null,isLoadingSuppliers:!1,urlReagent:"reagents",itemsReagent:[],searchReagent:null,isLoadingReagent:!1,urlConsumable:"consumables",itemsConsumable:[],searchConsumable:null,isLoadingConsumable:!1,urlItems:"complaints",urlItemsDetails_complaints:"details_complaints"}},watch:{search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProduct,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}},searchReagent:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoadingReagent=!0,this.$store.dispatch("request",{url:o.urlReagent,params:s}).then((function(t){o.itemsReagent=t.data.content})).finally((function(){return e.isLoadingReagent=!1}))}},searchConsumable:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoadingConsumable=!0,this.$store.dispatch("request",{url:o.urlConsumable,params:s}).then((function(t){o.itemsConsumable=t.data.content})).finally((function(){return e.isLoadingConsumable=!1}))}},searchSuppliers:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoadingSuppliers=!0,this.$store.dispatch("request",{url:o.urlSuppliers,params:s}).then((function(t){o.itemsSuppliers=t.data.content})).finally((function(){return e.isLoadingSuppliers=!1}))}}},created:function(){this.setHeaders(),this.getOptionsType(),this.getOptionsTypeAnomaly()},validations:function(){var t={form:{}};return t},methods:{getMethod:function(){return this.form.complaints?"PUT":"POST"},save_print_bills:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRoute()+"?print=1",method:e.getMethod(),data:e.getDataForm(),responseType:"blob"}).then((function(s){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(e.messages.success)});var o="Reclamation_"+(new Date).toISOString().substr(0,10),i=new Blob([s.data],{type:s.data.type});X.saveAs(i,o),"PUT"===t.getMethod()?e.$emit("getItems"):(e.$emit("getItems"),e.resetDataForm())})).catch((function(s){var o="$vuetify.error_server";if(s.response&&400===s.response.status){var i=s.response.data;e.setFormErrors(i),t.$forceUpdate();var a=Object.keys(i)[0];a&&Array.isArray(i[a])&&(o=i[a][0])}e.$store.dispatch("showNotification",{statut:!0,text:o,color:"#B71C1C"})})).finally((function(){e.loading=!1})))},getOptionsType:function(){var t=this;this._.each(this.$store.getters.type_product,(function(e){t.optionType.type_product.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},getOptionsTypeAnomaly:function(){var t=this;this._.each(this.$store.getters.anomaly,(function(e){t.optionAnomaly.type_anomaly.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},getNonePurchase:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsNonePurchase}).then((function(t){e(t)}))}))},forceRefresh:function(){this.dialog.show=!1,this.items=[],this.active=!1},deleteItem:function(t){this.urlDeleteItems=this.urlItemsDetails_complaints+"/"+t.id,this.dialogDelete.show=!0},setHeaders:function(){this.headers=[{text:"$vuetify.supplies.cols.product_name.title",value:"product_name",align:"start",sortable:!1,width:"140",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.product_code.title",value:"product_code",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.complaints.cols.anomaly.title",value:"type_anomaly",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.complaints.cols.other_anomaly.title",value:"other_anomaly",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.quantity.title",value:"quantity",align:"start",sortable:!1,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.actions.title",value:null,align:"start",sortable:!1,width:"70"}]},createD:function(){this.dialogForm.show=!0,this.messages={title:"$vuetify.product.new.title",submit:"$vuetify.product.new.submit",success:"$vuetify.product.new.success"}},createS:function(){this.dialogFormSupplies.show=!0,this.messages={title:"$vuetify.suppliers.new.title",submit:"$vuetify.suppliers.new.submit",success:"$vuetify.suppliers.new.success"}},getDataForm:function(){var t={witnesses:this.form.witnesses,responsible:this.form.responsible,stock_movement:this.form.stock_movement,delivery_person:this.form.delivery_person};return t},resetDataFormProduct:function(){this.formData.product=null,this.formData.quantity=null,this.formData.type_anomaly=null,this.formData.other_anomaly=null,this.formData.arrival_price=null,this.formData.total_amount=null},resetDataForm:function(){if(this.resetDataFormProduct(),this.form.product=null,this.form.id=null,this.items=[],!this.form.id){var t=this;this.$v.form.$reset(),this._.each(this.form,(function(e,s){"object"===Object(C["a"])(t.form[s])?t._.each(t.form[s],(function(e,o){"boolean"===typeof t.form[s][o]?t.form[s][o]=!1:t.form[s][o]=null})):"boolean"===typeof t.form[s]?t.form[s]=!1:t.form[s]=null})),this.resetItemsDetails()}},getDataFormdetails:function(){var t={type_product:this.formData.type_product,type_anomaly:this.formData.type_anomaly,other_anomaly:this.formData.other_anomaly,product:this.formData.product?this.formData.product["id"]:this.formData.product,total_amount:this.get_total_amount,quantity:this.formData.quantity,consumable:this.formData.consumable?this.formData.consumable["id"]:this.formData.consumable,reagent:this.formData.reagent?this.formData.reagent["id"]:this.formData.reagent,arrival_price:this.formData.arrival_price?this.formData.arrival_price:this.get_product_price};return t},setForm:function(t){var e,s,o,i,a,n,r,l,u,c,m,d,v,f;this.form.responsible=null===(e=t.complaints)||void 0===e||null===(s=e[0])||void 0===s?void 0:s.responsible,this.form.stock_movement=t.id,this.form.delivery_number=t.delivery_number,this.form.complaints=null===(o=t.complaints)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.id,this.form.delivery_person=null===(a=t.complaints)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.delivery_person,this.form.witnesses=null===(r=t.complaints)||void 0===r||null===(l=r[0])||void 0===l?void 0:l.witnesses,this.getItemsDetails(),this.form.complaints_date=(null===(u=t.complaints)||void 0===u||null===(c=u[0])||void 0===c?void 0:c.createdAt)+" "+(null===(m=t.complaints)||void 0===m||null===(d=m[0])||void 0===d?void 0:d.timeAt),this.form.purchase_amount=t.purchase_amount,this.form.delivery_person=t.delivery_person,this.form.code=null===(v=t.complaints)||void 0===v||null===(f=v[0])||void 0===f?void 0:f.code,this.form.order_date=t.createdAt,this.form.type_product=t.type_product},getRouteDetails:function(){return this.form.id?this.urlItemsDetails_complaints+"/"+this.form.id:this.urlItemsDetails_complaints},getRoute:function(){return this.form.complaints?this.urlItems+"/"+this.form.complaints:this.urlItems},refreshItemsDetail:function(){var t=this;this.loadingDetails.refresh=!0,this.getItemsDetails().then((function(){})).catch((function(){})).then((function(){t.loadingDetails.refresh=!1}))},getItemsDetails:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingDetails.list=!0,e.$store.dispatch("request",{url:e.urlItemsDetails_complaints+"/all?complaints="+t.form.complaints,params:a}).then((function(t){var o=t.data;e.items=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingDetails.list=!1,s()}))}))},resetItemsDetails:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingDetails.list=!0,e.$store.dispatch("request",{url:e.urlItemsDetails_complaints+"/all?complaints=reset",params:a}).then((function(t){var o=t.data;e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingDetails.list=!1,s()}))}))},editDetails:function(t){this.formData.product=t.product,this.formData.quantity=null===this.form.id?t.quantity:0,this.formData.arrival_price=t.arrival_price},saveDetails:function(){var t=this;console.log(this.getDataFormdetails()),this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRouteDetails(),method:e.getMethod(),data:e.getDataFormdetails()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.resetDataFormProduct()})).catch((function(s){var o;if(s.response)if(400===s.response.status){o="$vuetify.error_occured";var i=s.response.data;e.setFormErrors(i),t.$forceUpdate()}else o="$vuetify.error_server";e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(o),color:"#B71C1C"})})).then((function(){e.loading=!1})))}},computed:{get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.code,e},get_product_price:function(){var t="";return t=this.formData.product?this.formData.product.purchase_price:this.formData.reagent?this.formData.reagent.purchase_price:this.formData.consumable?this.formData.consumable.purchase_price:this.formData.consumable,t},get_complaints_amount:function(){var t=0;return this.items.forEach((function(e){t+=e.total_amount})),t},get_total_amount:function(){return this.formData.quantity?this.formData.arrival_price?this.formData.quantity*this.formData.arrival_price:this.formData.quantity*this.get_product_price:null!=this.formData.total_amount?this.formData.total_amount:0},nameErrors:function(){var t=[];return this.$v.form.name.$dirty?(!this.$v.form.name.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.name.required")),t):t},product_codeErrors:function(){var t=[];return this.$v.form.product_code.$dirty?(!this.$v.form.product_code.product_code&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.product_code.invalid")),!this.$v.form.product_code.unique&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.product_code.unique")),t):t},reference_noErrors:function(){var t=[];return this.$v.form.reference_no.$dirty?(!this.$v.form.reference_no.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.reference_no.required")),t):t},total_amountErrors:function(){var t=[];return this.$v.form.total_amount.$dirty?(!this.$v.form.total_amount.required&&t.push(this.$vuetify.lang.t("$vuetify.supplies.cols.total_amount.required")),t):t}},mounted:function(){this.getNonePurchase()},components:{DeleteItem:E["a"],FormProduct:G["a"],FormSuppliers:J["a"],FormDetails:W["a"]}},tt=Z,et=s("a844"),st=Object(v["a"])(tt,Q,K,!1,null,null,null),ot=st.exports;h()(st,{VAutocomplete:A["a"],VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCol:M["a"],VDataTable:O["a"],VDialog:g["a"],VDivider:b["a"],VForm:B["a"],VHover:T["a"],VIcon:j["a"],VRow:N["a"],VSelect:R["a"],VSpacer:$["a"],VTextField:L["a"],VTextarea:et["a"],VToolbar:H["a"],VTooltip:U["a"]});var it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{"max-width":"420",persistent:""},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[s("v-card",[s("v-card-text",[s("div",{staticClass:"body-1 font-weight-bold red--text",attrs:{align:"center"}},[s("br"),s("v-icon",{attrs:{color:"red",size:"55"}},[t._v("mdi-alert")]),s("br"),s("h2",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.inventory.isInventory"))+" ")]),s("div",{staticClass:"body-1 font-weight-bold"},[s("h3",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.inventory.continueInventory"))+" ")])])],1)]),s("v-divider"),s("v-card-actions",[s("v-spacer"),s("v-btn",{on:{click:function(e){t.dialog.show=!1}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.no"))+" ")]),s("v-btn",{attrs:{color:"#0984e3",loading:t.loading,dark:"",type:"submit"},on:{click:t.send}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.yes"))+" ")])],1)],1),s("form-inventory",{ref:"inventoryForm",attrs:{dialog:t.dialogFormInventory,form:t.form,messages:t.messages},on:{getItems:t.getInventory}})],1)},at=[],nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{persistent:"","max-width":"1000px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",color:"#f5f5f5",dense:""}},[s("div",{staticClass:"title",staticStyle:{color:"black"}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")]),s("v-spacer"),s("v-btn",{attrs:{icon:"",light:""},on:{click:function(e){t.forceRefresh(),t.resetDataForm()}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-form",{staticStyle:{"margin-top":"15px"}},[s("v-card-text",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.inventory.cols.code.title"),"prepend-inner-icon":"mdi-code-array",outlined:"",dense:"",filled:"",readonly:""},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.inventory.cols.date_inventory.title"),"prepend-inner-icon":"mdi-clock-start",outlined:"",dense:""},model:{value:t.form.date_inventory,callback:function(e){t.$set(t.form,"date_inventory",e)},expression:"form.date_inventory"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"7"}},[s("v-text-field",{staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.inventory.cols.reason_inventory.title"),"prepend-inner-icon":"mdi-script-text",outlined:"",dense:"",readonly:t.supply},model:{value:t.form.reason_inventory,callback:function(e){t.$set(t.form,"reason_inventory",e)},expression:"form.reason_inventory"}})],1)],1)],1),s("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-15px"}})],1),s("v-form",{attrs:{disabled:null===t.form.reason_inventory},on:{submit:function(e){return e.preventDefault(),t.saveDetails.apply(null,arguments)}}},[s("v-card-text",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"8"}},[s("v-autocomplete",{staticClass:"font-weight-bold",attrs:{items:t.itemsProduct,loading:t.isLoading,"search-input":t.search,color:"primary","item-text":"name","item-value":"id","return-object":"",label:t.$vuetify.lang.t("$vuetify.inventory.cols.product_name.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e}},scopedSlots:t._u([{key:"selection",fn:function(e){return[s("span",[t._v(t._s(e.item.ingredient.name)+" - "+t._s(e.item.quantity))])]}},{key:"item",fn:function(e){return[s("span",[t._v(t._s(e.item.ingredient.name)+" - "+t._s(e.item.quantity))])]}}]),model:{value:t.form.details_stock,callback:function(e){t.$set(t.form,"details_stock",e)},expression:"form.details_stock"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("v-text-field",{staticClass:"font-weight-bold ml-1",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.inventory.cols.quantity_adjusted.title"),outlined:"",dense:"",type:"number",min:"0",rules:[t.numberRule]},model:{value:t.form.quantity_adjusted,callback:function(e){t.$set(t.form,"quantity_adjusted",e)},expression:"form.quantity_adjusted"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"1"}},[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[s("v-btn",t._g({staticClass:"font-weight-bold",attrs:{color:"primary",loading:t.loadingBtn,dark:"",type:"submit",dense:"",small:"","max-width":"2px",disabled:null===t.form.details_stock||null===t.form.reason_inventory||null===t.form.quantity_adjusted}},o),[s("v-icon",{attrs:{dark:""}},[t._v(" mdi-content-save ")])],1)]}}])},[s("span",{staticClass:"text-center font-weight-bold body-2 withe--text text--d ken-1"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.add"))+" ")])])],1)],1)],1),s("v-card-actions",{staticStyle:{"margin-top":"-25px"}},[s("v-spacer"),s("v-btn",{staticClass:"mr-2 my-2",attrs:{color:"primary",depressed:"",dense:"",dark:"",loading:t.loadingBtn,disabled:null===t.form.reason_inventory||this.items.length<0},on:{click:function(e){return t.save()}}},[s("v-icon",[t._v(" mdi-content-save ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.inventory.new.submitinventory"))+" ")],1)],1),s("v-divider",{staticClass:"mx-4"})],1),s("v-card-text",[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headers,items:t.items,"items-per-page":t.itemPerPage,loading:t.loadingDetails.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.product_name",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity_adjusted",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.ingredient.name)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity_adjusted)+" ")]),s("td",{staticClass:"subtitle-2",attrs:{width:"50px"}},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:""},on:{click:function(s){return t.editDetails(e)}}},a),[s("v-icon",{attrs:{"mdi-18px":""}},[t._v("mdi-grease-pencil")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",{attrs:{"mdi-18px":""}},[t._v("mdi-delete-outline")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}])}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsDetails:t.getItemsDetails}})],1)],1)],1)},rt=[],lt={mixins:[c["a"]],props:{form:{type:Object,default:function(){return{id:null,inventory:null,amount:null,amount_adjusted:null,details_stock:null,quantity_stock:null,quantity_adjusted:null,product_code:null,date_inventory:null,reason_inventory:null,code:null,storage_depots:null}}}},data:function(){return{formData:{id:null,name:null,coefficient:null,number_account:null,quote_internal:null,quote_external:null},numberRule:function(t){return!(t<0)||"Entrer un nombre positif"},headers:[],items:[],meta:{},itemPerPage:10,itemPerPageOptions:[5,10,30],urlDeleteItems:"",sortDesc:!0,loading:{list:!1,refresh:!1,filter:!1},pagination:{},selectedItem:!1,_search:{},_sorts:{},dialogDelete:{show:!1},sortBy:["id"],e1:1,minDate:(new Date).toISOString().substr(0,10),isLoading:!1,search:null,inventories:null,menu2:!1,supply:!1,active:!1,menu3:!1,menu4:!1,menu:!1,isInventory:!1,dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormDetails:{show:!1,shows:{showFilter:!1,showInfo:!1}},messagesDelete:{success:"$vuetify.inventory.delete.success"},loadingBtn:!1,loadingDetails:{list:!1,refresh:!1,filter:!1},optionMovement:{type_Movement:[]},itemsProduct:[],urlProduct:"details_stocks/specify",urlItems:"inventories",urlItemsInv:"hospitals/isInventory",urlItemsDetails_inventory:"details_inventories",urlItemsNoneInv:"details_inventories/noneInv"}},watch:{"dialog.show":{immediate:!1,handler:function(t){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!t){s.next=7;break}if(e.form.id){s.next=4;break}return s.next=4,e.createEmptySupply();case 4:return s.next=6,e.getItemsDetails();case 6:e.form.date_inventory=(new Date).toISOString().slice(0,10);case 7:if(t){s.next=10;break}return s.next=10,e.deleteEmptySupply();case 10:case"end":return s.stop()}}),s)})))()}},search:function(t){var e=this;if(null!==t){var s={name_language:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProduct+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}}},created:function(){this.setHeaders()},validations:function(){var t={form:{}};return t},mounted:function(){window.addEventListener("keydown",(function(t){(t.metaKey||t.ctrlKey)&&t.keyCode==="r".charCodeAt(0)&&(t.preventDefault(),this.resetFormBills())}))},methods:{createEmptySupply:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:"inventories/create-empty",method:"POST"}).then((function(s){t.inventories=s.data.id,e(s)}))}))},deleteEmptySupply:function(){var t=this,e=this;return new Promise((function(s){e.$store.dispatch("request",{url:"inventories/"+t.inventories+"/delete-empty",method:"DELETE"}).then((function(t){s(t)}))}))},getOptionsMovement:function(){var t=this;this._.each(this.$store.getters.type_Movement,(function(e){t.optionMovement.type_Movement.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},forceRefresh:function(){this.dialog.show=!1,this.items=[],this.active=!1},deleteItem:function(t){this.urlDeleteItems=this.urlItemsDetails_inventory+"/"+t.id,this.dialogDelete.show=!0},setHeaders:function(){this.headers=[{text:"$vuetify.inventory.cols.product_name.title",value:"product_name",align:"start",sortable:!1,width:"70",class:"grey--text text--darken-3"},{text:"$vuetify.inventory.cols.quantity_adjusted.title",value:"quantity_adjusted",align:"start",sortable:!1,width:"30",class:"grey--text text--darken-3"},{text:"$vuetify.inventory.cols.actions.title",value:null,align:"start",sortable:!1,width:"70"}]},createD:function(){this.dialogForm.show=!0,this.formData={id:null,name:null,coefficient:null,number_account:null,quote_internal:null,quote_external:null}},getDataForm:function(){var t={inventory:this.inventories,reason_inventory:this.form.reason_inventory,storage_depots:this.$route.params.id};return t},getDataFormdetails:function(){var t={ingredient:this.form.details_stock.ingredient["id"],quantity_adjusted:this.form.quantity_adjusted,inventory:this.inventories,storage_depots:this.$route.params.id,cmup:this.get_product_cmup};return t},setForm:function(t){this.form.id=t.id,this.inventories=t.id,this.form.type_movement=t.type_movement,this.form.date_inventory=t.createdAt+" "+t.timeAt,this.form.reason_inventory=t.reason_inventory,this.form.code=t.code},getRouteDetails:function(){return this.form.id?this.urlItemsDetails_inventory+"/"+this.form.id:this.urlItemsDetails_inventory},getRoute:function(){return this.form.id?this.urlItems+"/"+this.form.id:this.urlItems},resetDataFormProduct:function(){this.form.details_stock=null,this.form.quantity_adjusted=null},resetDataForm:function(){if(this.form.id=null,this.items=[],!this.form.id){var t=this;this.$v.form.$reset(),this._.each(this.form,(function(e,s){"object"===Object(C["a"])(t.form[s])?t._.each(t.form[s],(function(e,o){"boolean"===typeof t.form[s][o]?t.form[s][o]=!1:t.form[s][o]=null})):"boolean"===typeof t.form[s]?t.form[s]=!1:t.form[s]=null}))}},refreshItemsDetail:function(){var t=this;this.loadingDetails.refresh=!0,this.getItemsDetails().then((function(){})).catch((function(){})).then((function(){t.loadingDetails.refresh=!1}))},editDetails:function(t){this.form.details_stock=t.details_stock},getDataFormInv:function(){var t={is_inventory:!1};return t},save:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRoute(),method:e.getMethod(),data:e.getDataForm()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.inventory.new.success")}),e.$emit("getInventory"),e.resetDataForm(),t.dialog.show=!1,e.$emit("getOpenCash")})).catch((function(s){var o="$vuetify.error_server";if(s.response&&400===s.response.status){var i=s.response.data;e.setFormErrors(i),t.$forceUpdate();var a=Object.keys(i)[0];a&&Array.isArray(i[a])&&(o=i[a][0])}e.$store.dispatch("showNotification",{statut:!0,text:o,color:"#B71C1C"})})).finally((function(){e.loading=!1})))},getOpenCash:function(){var t=this,e=this;return new Promise((function(s){e.$store.dispatch("request",{url:e.urlItemsCash}).then((function(o){var i=o.data;e.isActive=i.content.is_active,e.isInventory=i.content.is_inventory,!0===e.isInventory&&t.currentInventory(),s(o)}))}))},getItemsDetails:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingDetails.list=!0,e.$store.dispatch("request",{url:e.urlItemsDetails_inventory+"?inventory="+t.inventories,params:a}).then((function(t){var o=t.data;e.items=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingDetails.list=!1,s()}))}))},saveDetails:function(){var t=this;this.$store.dispatch("showNotification",{statut:!1});var e=this;e.$v.$touch(),e.$v.$invalid||(this.loading=!0,this.$store.dispatch("request",{url:e.getRouteDetails(),method:e.getMethod(),data:e.getDataFormdetails()}).then((function(){e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t("$vuetify.supplies.new.successDetails")}),t.getItemsDetails(),e.resetDataFormProduct()})).catch((function(s){var o;if(s.response)if(400===s.response.status){o="$vuetify.error_occured";var i=s.response.data;e.setFormErrors(i),t.$forceUpdate()}else o="$vuetify.error_server";e.$store.dispatch("showNotification",{statut:!0,text:e.$vuetify.lang.t(o),color:"#B71C1C"})})).then((function(){e.loading=!1})))}},computed:{get_product_code:function(){var t,e,s="";return s=null===this.form.details_stock?"":null===(t=this.form.details_stock)||void 0===t||null===(e=t.product)||void 0===e?void 0:e.code,s},get_product_cmup:function(){var t,e="";return e=null===this.form.details_stock?"":null===(t=this.form.details_stock)||void 0===t?void 0:t.cmup,e},get_product_stock:function(){var t,e="";return e=null===this.form.details_stock?"":null===(t=this.form.details_stock)||void 0===t?void 0:t.qte_stock,e},get_amount:function(){var t,e,s,o;return(null===(t=this.form.details_stock)||void 0===t?void 0:t.qte_stock)&&(null===(e=this.form.details_stock)||void 0===e?void 0:e.cmup)?(null===(s=this.form.details_stock)||void 0===s?void 0:s.cmup)*(null===(o=this.form.details_stock)||void 0===o?void 0:o.qte_stock):null!=this.form.amount?this.form.amount:0},get_amount_adjusted:function(){var t,e;return this.form.quantity_adjusted&&(null===(t=this.form.details_stock)||void 0===t?void 0:t.cmup)?this.form.quantity_adjusted*(null===(e=this.form.details_stock)||void 0===e?void 0:e.cmup):null!=this.form.amount_adjusted?this.form.amount_adjusted:0},nameErrors:function(){var t=[];return this.$v.form.name.$dirty?(!this.$v.form.name.required&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.name.required")),t):t},product_codeErrors:function(){var t=[];return this.$v.form.product_code.$dirty?(!this.$v.form.product_code.product_code&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.product_code.invalid")),!this.$v.form.product_code.unique&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.product_code.unique")),t):t},type_movementErrors:function(){var t=[];return this.$v.form.type_movement.$dirty?(!this.$v.form.type_movement.required&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.type_movement.required")),t):t},operation_dateErrors:function(){var t=[];return this.$v.form.operation_date.$dirty?(!this.$v.form.operation_date.required&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.birthday.required")),t):t},total_amountErrors:function(){var t=[];return this.$v.form.total_amount.$dirty?(!this.$v.form.total_amount.required&&t.push(this.$vuetify.lang.t("$vuetify.inventory.cols.total_amount.required")),t):t}},components:{DeleteItem:E["a"]}},ut=lt,ct=Object(v["a"])(ut,nt,rt,!1,null,null,null),mt=ct.exports;h()(ct,{VAutocomplete:A["a"],VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCol:M["a"],VDataTable:O["a"],VDialog:g["a"],VDivider:b["a"],VForm:B["a"],VHover:T["a"],VIcon:j["a"],VRow:N["a"],VSpacer:$["a"],VTextField:L["a"],VToolbar:H["a"],VTooltip:U["a"]});var dt={mixins:[c["a"]],name:"Infos",props:{dialog:{type:Object,default:function(){return{shows:{showInfo:!1}}}},form:{type:Object,default:function(){return{id:null,code_user:null,position_held:null,doctor:null,patient:null,username:null,password:null,re_password:null,role:null,is_active:!1}}}},data:function(){return{loading:!1,urlItems:"hospitals/isInventory",urlInventory:"inventories/get_inventory",dialogFormInventory:{show:!1,shows:{showFilter:!1,showInfo:!1}},messages:{title:"",submit:"",success:""}}},methods:{getInventory:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loading.list=!0,e.$store.dispatch("request",{url:e.urlInventory+"?id="+t.$route.params.id,params:a}).then((function(t){var o=t.data;e.itemsInventory=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loading.list=!1,s()}))}))},createInventory:function(){this.dialogFormInventory.show=!0,this.messages={title:"$vuetify.inventory.new.title",submit:"$vuetify.inventory.new.submit",success:"$vuetify.inventory.new.success"},this.$refs.inventoryForm.setForm()},getDataForm:function(){var t={is_inventory:!0};return t},send:function(){var t=this;this.dialog.show=!1,this.$store.dispatch("setNotification",{status:!1});var e=this;this.loading=!0,this.$store.dispatch("request",{url:e.urlItems,method:"PATCH",data:e.getDataForm()}).then((function(){e.$store.dispatch("setNotification",{status:!0,message:e.$vuetify.lang.t(e.messages.success)}),t.createInventory(),e.$emit("getOpenCash"),e.$emit("getInventory")})).catch((function(t){console.log("error",t);var s="$vuetify.error_occured";e.$store.dispatch("setNotification",{status:!0,message:e.$vuetify.lang.t(s)})})).then((function(){e.loading=!1}))}},components:{FormInventory:mt}},vt=dt,ft=Object(v["a"])(vt,it,at,!1,null,null,null),ht=ft.exports;h()(ft,{VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VDialog:g["a"],VDivider:b["a"],VIcon:j["a"],VSpacer:$["a"]});var pt=s("2b0e"),_t=s("f2d9"),yt=s("21a6");pt["a"].component("downloadExcel",_t["a"]);var gt={mixins:[a["a"]],data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{start_date:null,end_date:null,product:null,productAvailable:null,date:null,optionExport:null},optionMovement:{type_Movement:[]},itemsStock_movement:[],headersStock_movement:[],itemsProduct:[],isInventory:!1,urlItemsCash:"cashs/isOpen",showStocks_movements:!1,urlProduct:"products",urlProductPlus:"details_stocks/specify",urlItemsStock_movement:"details_stock_movement/get_items",urlItemsExportStock_movement:"stock_movements",urlItems:"stock_movements",sortBy:["createdAt","timeAt"],menu5:!1,menu2:!1,search:null,isLoading:!1,menu:!1,optionsExport:{type_Export:[]},loadingBtn:!1,loadingItemStock_movement:{list:!1,refresh:!1,filter:!1},loadingStockMovement:{list:!1,refresh:!1,filter:!1},dialogFormInv:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},json_fields:{Code:"product.code",Name:"product.name",DCI:"product.dci1.name",Forme:"product.shape.name",Categorie:"product.category.name",Conditionnement:"product.conditioning",Quantite:"qte_stock",CMUP:"cmup",MontantT:"total"},dialogFormExportMovement:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormFilterMov:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogFormStock_movement:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogDelete:{show:!1},dialogDetail:{show:!1},dialogEnt:{show:!1},exports:{id:null,type_movement:null,email:null,code:null,password:null,role:null,is_active:null},dialogFormComplaints:{show:!1,shows:{showFilter:!1,showInfo:!1}},form:{type_movement:null,role:null},filter:{type_movement:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.storage_depots.delete.success"}}},watch:{search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}},pagination:{handler:function(){this.get_stock_movement()},deep:!0}},created:function(){this.setHeadersStock_movement(),this.get_options_export(),this.getOptionsMovement()},methods:{enabled:function(t){this.$refs.enableUser.setForm(t),t.is_active?(this.dialogForm.shows.showInfo=!0,this.messages={title:"$vuetify.stock_movement.cols.is_valid.desabled",submit:"$vuetify.stock_movement.update.submit",success:"$vuetify.stock_movement.update.success"}):(this.dialogForm.shows.showInfo=!0,this.messages={title:"$vuetify.stock_movement.cols.is_valid.enabled",submit:"$vuetify.stock_movement.update.submit",success:"$vuetify.stock_movement.update.success"})},getOptionsMovement:function(){var t=this;this._.each(this.$store.getters.type_Movement_stock,(function(e){t.optionMovement.type_Movement.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},exportPrint:function(){var t=this,e=this,s={};null!==e.filter.type_movement&&(s["type_movement"]=e.filter.type_movement),this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/print",params:s,responseType:"blob"}).then((function(e){var s=new Blob([e.data],{type:e.data.type}),o=URL.createObjectURL(s);t.editPdf(o)})),this.$store.dispatch("showNotification",{statut:!1})},exportPDF:function(){var t=this,e={};null!==t.filter.category&&(e["category"]=t.filter.category),this._.isEmpty(this._search)||(this._search=this._.merge(e,this._search)),t.$store.dispatch("request",{url:t.urlItemsExportStock_movement+"/print",params:e,responseType:"blob"}).then((function(t){var e="Listes des produits",s=new Blob([t.data],{type:t.data.type});yt.saveAs(s,e)})),this.$store.dispatch("showNotification",{statut:!1})},showExportMovement:function(){this.dialogFormExportMovement.shows.showFilter=!0},performExportMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.getItemsExportMovement()},getItemsExportMovement:function(){var t=this,e=this,s={};this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/export",params:s,responseType:"blob"}).then((function(e){var s="Liste des mouvements de stock",o=new Blob([e.data],{type:e.data.type});yt.saveAs(o,s),t.dialogFormExportMovement.shows.showFilter=!1}))},currentInventory:function(){this.dialogFormInvent.show=!0},getOpenCash:function(){var t=this,e=this;return new Promise((function(s){e.$store.dispatch("request",{url:e.urlItemsCash}).then((function(o){var i=o.data;e.isInventory=i.content.is_inventory,!0===e.isInventory&&t.currentInventory(),s(o)}))}))},resetDate:function(){this.formData.date=null,this.menu5=!1,this.$refs.menu5.save(this.formData.date)},get_options_export:function(){var t=this;this._.each(this.$store.getters.export,(function(e){t.optionsExport.type_Export.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},get_data_form:function(){var t={product:this.formData.product.product["id"],end_date:this.formData.end_date,storage_depots:this.$route.params.id,start_date:this.formData.start_date};return t},getMethod:function(){return this.form.id?"PUT":"POST"},refresh_stock_movement:function(){var t=this;this.loadingStockMovement.refresh=!0,this.get_stock_movement().then((function(){})).catch((function(){})).then((function(){t.loadingStockMovement.refresh=!1}))},get_stock_movement:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loading.list=!0,e.$store.dispatch("request",{url:e.urlItems+"?storage_depots="+t.$route.params.id,params:a}).then((function(t){var o=t.data;e.itemsStock_movement=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loading.list=!1,s()}))}))},setHeadersStock_movement:function(){this.headersStock_movement=[{text:"$vuetify.stock_movement.cols.code.title",value:"code",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.date_movement.title",value:"date_movement",align:"start",sortable:!0,width:"15",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.type_movement.title",value:"type_movement",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.reason_movement.title",value:"reason_movement",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.product_code.title",value:"product_code",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.movement_value.title",value:"movement_value",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.is_valid.title",value:"is_valid",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.users.cols.created.title",value:"create_date",align:"start",sortable:!0,width:"105",class:"grey--text text--darken-3"},{text:"$vuetify.product.cols.actions.title",value:null,align:"start",sortable:!0,width:"12"}]},create_movement:function(){this.dialogFormStock_movement.show=!0,this.messages={title:"$vuetify.stock_movement.new.title",submit:"$vuetify.stock_movement.new.submit",success:"$vuetify.stock_movement.new.success"}},editStock_movement:function(t){this.dialogFormStock_movement.show=!0,this.messages={title:"$vuetify.stock_movement.update.title",submit:"$vuetify.stock_movement.update.submit",success:"$vuetify.stock_movement.update.success"},this.$refs.stock_movementForm.setForm(t)},showFilter:function(){this.dialogForm.shows.showFilter=!0},showFilterMovement:function(){this.dialogFormFilterMov.shows.showFilter=!0},viewComplaints:function(t){this.dialogFormComplaints.show=!0,this.messages={title:"$vuetify.complaints.update.title",submit:"$vuetify.complaints.update.submit",success:"$vuetify.complaints.update.success"},this.$refs.complaintsForm.setForm(t)},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.code&&(e["code"]=t.filter.code),null!==t.filter.role&&(e["role"]=t.filter.role),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))},performFilterMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.get_stock_movement()},assignEnterprise:function(t){this.dialogEnt.show=!0,this.$refs.assignForm.setForm(t)}},computed:{getMinStartDate:function(){var t,e="";return e=null===(t=new Date(this.formData.start_date))||void 0===t?void 0:t.toISOString().substr(0,10),e},get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.product.code,e}},mounted:function(){this.getOpenCash(),this.get_stock_movement()},components:{FormMovement:z,FormInv:ht,FormEnable:w,FormComplaints:ot,DeleteItem:x["a"]}},bt=gt,$t=Object(v["a"])(bt,n,r,!1,null,"31c219d0",null),kt=$t.exports;h()($t,{VBtn:p["a"],VCard:_["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:M["a"],VDataTable:O["a"],VHover:T["a"],VIcon:j["a"],VRow:N["a"],VSelect:R["a"],VSpacer:$["a"],VTooltip:U["a"]});var wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._.includes(this.$auth.user().permissions,"view_items_movements")?s("div",[s("v-card",{staticClass:"pb-4"},[s("div",{staticClass:"mt-5 mx-5"},[[s("v-form",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-menu",{attrs:{color:"primary","close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[s("v-text-field",t._g(t._b({staticClass:"font-weight-bold my-2",attrs:{color:"primary",outlined:"",label:t.$vuetify.lang.t("$vuetify.item_movements.cols.period_of.title"),dense:"",readonly:"",clearable:""},model:{value:t.formData.start_date,callback:function(e){t.$set(t.formData,"start_date",e)},expression:"formData.start_date"}},"v-text-field",i,!1),o))]}}],null,!1,1711058367),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[s("v-date-picker",{attrs:{max:t.maxDate,color:"primary"},on:{input:function(e){t.menu=!1}},model:{value:t.formData.start_date,callback:function(e){t.$set(t.formData,"start_date",e)},expression:"formData.start_date"}})],1)],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-menu",{attrs:{color:"primary","close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[s("v-text-field",t._g(t._b({staticClass:"font-weight-bold my-2",attrs:{color:"primary",outlined:"",label:t.$vuetify.lang.t("$vuetify.item_movements.cols.period_of.title2"),dense:"",readonly:"",clearable:""},model:{value:t.formData.end_date,callback:function(e){t.$set(t.formData,"end_date",e)},expression:"formData.end_date"}},"v-text-field",i,!1),o))]}}],null,!1,3603547266),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[s("v-date-picker",{attrs:{min:t.getMinStartDate,max:t.maxDate,color:"primary"},on:{input:function(e){t.menu2=!1}},model:{value:t.formData.end_date,callback:function(e){t.$set(t.formData,"end_date",e)},expression:"formData.end_date"}})],1)],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"4"}},[s("v-autocomplete",{staticClass:"font-weight-bold my-2",attrs:{items:t.itemsProduct,loading:t.isLoading,"search-input":t.search,color:"primary","return-object":"","item-text":"product_name","item-value":"id",label:t.$vuetify.lang.t("$vuetify.supplies.cols.product_name.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e},change:t.getItemBills},model:{value:t.formData.product,callback:function(e){t.$set(t.formData,"product",e)},expression:"formData.product"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"1"}},[s("v-btn",{staticClass:"font-weight-bold my-2 white--text",attrs:{color:"teal darken-1",light:"",loading:t.loadingBtn,disabled:null===t.formData.product||null===t.formData.start_date||null===t.formData.end_date},on:{click:function(e){return t.exportItemMovement()}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.item_movements.cols.period_of.title4"))+" ")])],1)],1)],1)],s("v-spacer")],2)]),s("v-card",{staticClass:"pb-4"},[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headersItemBills,items:t.itemsItemBills,"items-per-page":t.itemPerPage,loading:t.loadingItemBills.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.type_movement",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.name",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.date_movement",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.stock_initial",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity_used",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",[s("tbody",t._l(o,(function(e,o){return s("tr",{key:o},[e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.bills.code)+" ")]):e.supplies?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.supplies.code)+" ")]):e.stock_movement?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.stock_movement.code)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("/")]),e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.bills.bills"))+" ")]):e.supplies?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.supplies.title"))+" ")]):e.stock_movement?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.stock_movement.title"))+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("/")]),e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.bills.patient.name)+" ")]):e.supplies?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.supplies.suppliers.name)+" ")]):e.stock_movement?s("td",{staticClass:"subtitle-2"},[s("v-tooltip",{attrs:{top:""},scopedSlots:t._u(["ENTRY"===e.stock_movement.type_movement?{key:"activator",fn:function(o){var i=o.on;return[s("v-icon",t._g({staticClass:"pointer",staticStyle:{"font-size":"15px"},attrs:{color:"teal darken-1",dark:""}},i),[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.cash_movement.cols.type."+e.stock_movement.type_movement))+" ")])]}}:{key:"activator",fn:function(o){var i=o.on;return[s("v-icon",t._g({staticClass:"pointer",staticStyle:{"font-size":"15px"},attrs:{color:"red accent-4",dark:""}},i),[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.cash_movement.cols.type."+e.stock_movement.type_movement))+" ")])]}}],null,!0)})],1):s("td",{staticClass:"subtitle-2"},[t._v("/")]),e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.bills.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]):e.supplies?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.supplies.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]):e.stock_movement?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.stock_movement.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("/")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.stock_initial)+" ")]),e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity_served)+" ")]):e.supplies||e.stock_movement?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("/")]),e.bills?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.stock_initial-e.quantity_served)+" ")]):e.supplies||e.stock_movement?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.stock_initial+e.quantity)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v("/")])])})),0)])]}}],null,!1,2564647321)}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsDetails:t.getItemsDetails}})],1)],1):t._e()])},xt=[],Dt=s("21a6");pt["a"].component("downloadExcel",_t["a"]);var It={mixins:[a["a"]],data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{start_date:null,end_date:null,product:null,productAvailable:null,date:null,optionExport:null},itemsItemBills:[],headersItemBills:[],itemsProduct:[],urlItemsCash:"cashs/isOpen",showItem_movements:!1,urlProduct:"products",urlProductPlus:"details_stocks/specify",urlItemsBills:"details_bills/get_items",urlItemsSupplies:"details_supplies/get_items",urlItems:"details_stock_movement/get_items",sortBy:["createdAt","timeAt"],menu5:!1,menu2:!1,loadingBtn:!1,search:null,isLoading:!1,menu:!1,optionsExport:{type_Export:[]},loadingItemBills:{list:!1,refresh:!1,filter:!1},dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},json_fields:{Code:"product.code",Name:"product.name",DCI:"product.dci1.name",Forme:"product.shape.name",Categorie:"product.category.name",Conditionnement:"product.conditioning",Quantite:"qte_stock",CMUP:"cmup",MontantT:"total"},dialogDelete:{show:!1},dialogDetail:{show:!1},dialogEnt:{show:!1},exports:{id:null,type_movement:null,email:null,code:null,password:null,role:null,is_active:null},form:{type_movement:null,role:null},filter:{type_movement:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.storage_depots.delete.success"}}},watch:{search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}},pagination:{handler:function(){this.getItems()},deep:!0}},created:function(){this.setHeadersItemBills(),this.setHeadersItemSupplies()},methods:{currentInventory:function(){this.dialogFormInv.show=!0},editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},getOpenCash:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsCash}).then((function(s){var o=s.data;t.isInventory=o.content.is_inventory,e(s)}))}))},resetDate:function(){this.formData.date=null,this.menu5=!1,this.$refs.menu5.save(this.formData.date)},itemMovement:function(){this.loadingItemBills.refresh=!0,this.getItemBills().then((function(){})).catch((function(){})).then((function(){self.loadingItemBills.refresh=!1}))},exportItemMovement:function(){var t=this;t.$store.dispatch("request",{url:t.urlProduct+"/export_items?product="+this.formData.product.product.id+"&start_date="+this.formData.start_date+"&end_date="+this.formData.end_date+"&id="+this.$route.params.id,responseType:"blob"}).then((function(t){var e="Historique des sessions",s=new Blob([t.data],{type:t.data.type});Dt.saveAs(s,e)}))},getDataForm:function(){var t={product:this.formData.product.product["id"],end_date:this.formData.end_date,storage_depots:this.$route.params.id,start_date:this.formData.start_date};return t},getMethod:function(){return this.form.id?"PUT":"POST"},getItemBills:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return a["storage_depots"]=this.$route.params.id,null!==e.formData.start_date&&(a["start_date"]=e.formData.start_date),null!==e.formData.end_date&&(a["end_date"]=e.formData.end_date),null!==e.formData.product&&(a["product"]=e.formData.product.product.id),this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingItemBills.list=!0,e.$store.dispatch("request",{url:e.urlItems,method:"GET",params:a}).then((function(t){var o=t.data;e.itemsItemBills=o.content.bills,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingItemBills.list=!1,s()}))}))},setHeadersItemBills:function(){this.headersItemBills=[{text:"$vuetify.bills.cols.code.title",value:"code",align:"start",sortable:!0,width:"80",class:"grey--text text--darken-3"},{text:"$vuetify.expenses_nature.title",value:"type_movement",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.name.title",value:"name",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.date_movement.title",value:"date_movement",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.stock_initial.title",value:"stock_initial",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity_used.title",value:"quantity_used",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity.title",value:"quantity",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"}]},setHeadersItemSupplies:function(){this.headersItemSupplies=[{text:"$vuetify.supplies.cols.code.title",value:"code",align:"start",sortable:!0,width:"80",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.supplier.title",value:"suppliers",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.created.title",value:"createdAt",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.stock_initial.title",value:"stock_initial",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.quantity.title",value:"quantity",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.arrival_price.title",value:"arrival_price",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.total_amount.title",value:"total_amount",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"}]},showFilter:function(){this.dialogForm.shows.showFilter=!0},showFilterMovement:function(){this.dialogFormFilterMov.shows.showFilter=!0},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.code&&(e["code"]=t.filter.code),null!==t.filter.role&&(e["role"]=t.filter.role),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))},performFilterMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.getStockMovement()},assignEnterprise:function(t){this.dialogEnt.show=!0,this.$refs.assignForm.setForm(t)}},computed:{getMinStartDate:function(){var t,e="";return e=null===(t=new Date(this.formData.start_date))||void 0===t?void 0:t.toISOString().substr(0,10),e},get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.product.code,e}},mounted:function(){this.getOpenCash(),this.getItemBills()},components:{DeleteItem:x["a"]}},Ct=It,Ft=s("2e4b"),St=s("e449"),Et=Object(v["a"])(Ct,wt,xt,!1,null,"07ece648",null),Pt=Et.exports;h()(Et,{VAutocomplete:A["a"],VBtn:p["a"],VCard:_["a"],VCol:M["a"],VDataTable:O["a"],VDatePicker:Ft["a"],VForm:B["a"],VHover:T["a"],VIcon:j["a"],VMenu:St["a"],VRow:N["a"],VSpacer:$["a"],VTextField:L["a"],VTooltip:U["a"]});var qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._.includes(this.$auth.user().permissions,"view_stock_available")?s("div",[s("v-card",{staticClass:"pb-4"},[s("div",{staticClass:"mt-5 mx-5"},[s("v-form",[s("v-row",{attrs:{wrap:""}},[s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"6"}},[s("v-autocomplete",{staticClass:"font-weight-bold my-2",attrs:{items:t.itemsProductAvailable,loading:t.isLoadingAvailable,"search-input":t.searchAvailable,color:"primary","return-object":"","item-text":"ingredient","item-value":"id",label:t.$vuetify.lang.t("$vuetify.ingredient.title"),outlined:"",dense:"",clearable:""},on:{"update:searchInput":function(e){t.searchAvailable=e},"update:search-input":function(e){t.searchAvailable=e},change:t.getItemsStock},scopedSlots:t._u([{key:"selection",fn:function(e){return[t._v(" "+t._s(e.item.ingredient.name)+" ")]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.ingredient.name)+" ")]}},{key:"label",fn:function(){return[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.ingredient.title"))+" ")]},proxy:!0}],null,!1,559832727),model:{value:t.formData.productAvailable,callback:function(e){t.$set(t.formData,"productAvailable",e)},expression:"formData.productAvailable"}})],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"2"}},[s("v-menu",{attrs:{color:"primary",":close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[s("v-text-field",t._g(t._b({staticClass:"font-weight-bold my-2",attrs:{color:"primary",outlined:"",label:t.$vuetify.lang.t("$vuetify.statistics.sell_month_stat_date"),dense:"",clearable:"",readonly:""},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}},"v-text-field",i,!1),o))]}}],null,!1,4118164416),model:{value:t.menu5,callback:function(e){t.menu5=e},expression:"menu5"}},[s("v-date-picker",{attrs:{max:t.maxDate,color:"primary"},on:{change:t.getItemsStock,input:function(e){t.menu5=!1}},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}})],1)],1),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"3"}},[s("download-excel",{staticClass:"btn btn-default",attrs:{data:t.stockAvailableWithTotal,fields:t.json_fields,worksheet:"My Worksheet",name:"Liste des produits.xls"}},[s("v-btn",{staticClass:"mt-2 white--text",attrs:{color:"teal darken-1"}},[t._v(" Export xls "),s("i",{staticClass:"mdi mdi-export-variant",attrs:{"aria-hidden":"true"}})])],1)],1)],1)],1),s("v-spacer")],1)]),s("v-card",[s("v-data-table",{directives:[{name:"show",rawName:"v-show",value:t.showStock_available,expression:"showStock_available"}],staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headersStock_available,items:t.stockAvailableWithTotal,"items-per-page":t.itemPerPage,loading:t.loadingStockAvailable.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.name",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.quantity_two",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[e.ingredient?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.ingredient.code)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.code)+" ")]),e.ingredient?s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.ingredient.name)+" ")]):s("td",{staticClass:"subtitle-2"},[t._v(t._s(e.name))]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.quantity_two)+" ")]),s("td",{staticClass:"subtitle-2"},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",[t._v("mdi-delete-outline")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}],null,!1,105507483)}),s("form-update",{ref:"updateExpiryDate",attrs:{dialog:t.dialogForm,messages:t.messages},on:{getItemsStock:t.getItemsStock}}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItemsStock:t.getItemsStock}})],1)],1):t._e()])},At=[],Vt=(s("d81d"),s("5530")),Mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{"max-width":"300"},model:{value:t.dialog.shows.showInfo,callback:function(e){t.$set(t.dialog.shows,"showInfo",e)},expression:"dialog.shows.showInfo"}},[s("v-card",[s("v-card-text",[s("div",{staticClass:"body-1 font-weight-bold"},[s("br"),s("h3",[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.title))+" ")])])]),s("v-col",{staticClass:"mb-0 py-0",attrs:{cols:"12",sm:"12"}},[s("v-menu",{attrs:{color:"primary","close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto",dense:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,i=e.attrs;return[s("v-text-field",t._g(t._b({staticClass:"font-weight-bold",attrs:{color:"primary",label:t.$vuetify.lang.t("$vuetify.product.cols.expiry_date.title"),"prepend-inner-icon":"mdi-clock-start",outlined:"",dense:""},model:{value:t.form.expiry_date,callback:function(e){t.$set(t.form,"expiry_date",e)},expression:"form.expiry_date"}},"v-text-field",i,!1),o))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[s("v-date-picker",{attrs:{color:"primary"},on:{input:function(e){t.menu=!1}},model:{value:t.form.expiry_date,callback:function(e){t.$set(t.form,"expiry_date",e)},expression:"form.expiry_date"}})],1)],1),s("v-divider"),s("v-card-actions",[s("v-spacer"),s("v-btn",{on:{click:function(e){t.dialog.shows.showInfo=!1}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.close"))+" ")]),s("v-btn",{attrs:{color:"#0984e3",loading:t.loading,dark:"",type:"submit"},on:{click:t.send}},[t._v(" "+t._s(t.$vuetify.lang.t(t.messages.submit))+" ")])],1)],1)],1)},Ot=[],Bt={mixins:[c["a"]],name:"Infos",props:{dialog:{type:Object,default:function(){return{shows:{showInfo:!1}}}},form:{type:Object,default:function(){return{id:null,code_user:null,position_held:null,expiry_date:null,patient:null,username:null,password:null,re_password:null,role:null,is_active:!1}}}},data:function(){return{loading:!1,menu:!1,urlItems:"details_stocks"}},methods:{setForm:function(t){this.form.id=t.id,this.form.expiry_date=t.expiry_date},getDataForm:function(){var t={expiry_date:this.form.expiry_date};return t},getRoute:function(){return this.form.id?this.urlItems+"/"+this.form.id:this.urlItems},send:function(){this.$store.dispatch("setNotification",{status:!1});var t=this;this.loading=!0,this.$store.dispatch("request",{url:t.getRoute(),method:"PATCH",data:t.getDataForm()}).then((function(){t.$store.dispatch("setNotification",{status:!0,message:t.$vuetify.lang.t(t.messages.success)}),t.$emit("getItemsStock")})).catch((function(e){console.log("error",e);var s="$vuetify.error_occured";t.$store.dispatch("setNotification",{status:!0,message:t.$vuetify.lang.t(s)})})).then((function(){t.loading=!1}))}}},Tt=Bt,jt=Object(v["a"])(Tt,Mt,Ot,!1,null,null,null),Nt=jt.exports;h()(jt,{VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCol:M["a"],VDatePicker:Ft["a"],VDialog:g["a"],VDivider:b["a"],VMenu:St["a"],VSpacer:$["a"],VTextField:L["a"]});var Rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{"max-width":"400px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[s("v-card",[s("v-card-text",[s("v-divider",{staticClass:"mx-4"}),s("v-card-text",[s("div",{staticClass:"body-1 font-weight-bold"},[s("br"),s("h3",[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.delete.confirm"))+" ")])])]),s("br")],1),s("v-divider",{staticClass:"mx-4",staticStyle:{"margin-top":"-30px"}}),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{disabled:t.loading},on:{click:function(e){t.dialog.show=!1}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.no"))+" ")]),s("v-btn",{attrs:{loading:t.loading,dark:"",color:"#0984e3"},on:{click:function(e){return t.deleteItem()}}},[t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.yes"))+" ")])],1)],1)],1)},Lt=[],Ht={props:{dialog:{type:Object,default:function(){return{show:!1}}},urlItems:{type:String,default:""},messages:{type:Object,default:function(){return{success:""}}}},data:function(){return{loading:!1}},methods:{deleteItem:function(){var t=this;this.loading=!0,this.$store.dispatch("request",{url:t.urlItems,method:"DELETE",data:t.urlDeleteItems}).then((function(){t.$store.dispatch("showNotification",{statut:!0,text:t.$vuetify.lang.t("$vuetify.supplies.delete.successDetails")}),t.$emit("getItemsStock"),t.dialog.show=!1})).catch((function(e){console.log("erreur delete",e),t.$store.dispatch("showNotification",{statut:!0,text:t.$vuetify.lang.t("$vuetify.deletedErrors")})})).then((function(){t.loading=!1}))}}},Ut=Ht,Yt=Object(v["a"])(Ut,Rt,Lt,!1,null,null,null),zt=Yt.exports;h()(Yt,{VBtn:p["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VDialog:g["a"],VDivider:b["a"],VSpacer:$["a"]});var Qt=s("21a6");pt["a"].component("downloadExcel",_t["a"]);var Kt={mixins:[a["a"]],data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{start_date:null,end_date:null,product:null,productAvailable:null,date:null,optionExport:null},itemsStock_available:[],headersStock_available:[],itemsProduct:[],messagesInv:{type:Object,default:function(){return{title:"",success:"",submit:""}}},isInventory:!1,dialogFormInvent:{show:!1,shows:{showFilter:!1,showInfo:!1}},urlItemsCash:"cashs/isOpen",showStock_available:!1,urlProduct:"products",urlItems:"details_stocks",urlProductPlus:"details_stocks/specify",urlItemsStock:"details_stocks/stock_available",sortBy:["createdAt","timeAt"],menu5:!1,menu2:!1,search:null,isLoading:!1,searchAvailable:null,isLoadingAvailable:!1,itemsProductAvailable:[],menu:!1,optionsExport:{type_Export:[]},dialogFormInv:{show:!1,shows:{showFilter:!1,showInfo:!1}},loadingStockAvailable:{list:!1,refresh:!1,filter:!1},loadingBtn:!1,dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},json_fields:{Code:"product.code",Name:"product.name",DCI:"product.dci1.name",Forme:"product.shape.name",Categorie:"product.category.name",Date_expiration:"expiry_date",Quantite:"qte_stock"},dialogDelete:{show:!1},dialogDetail:{show:!1},dialogEnt:{show:!1},exports:{id:null,type_movement:null,email:null,code:null,password:null,role:null,is_active:null},form:{type_movement:null,role:null},filter:{type_movement:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.storage_depots.delete.success"}}},watch:{"$route.params.id":{immediate:!0,handler:function(){this.getItemsStock()}},search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}},searchAvailable:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoadingAvailable=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProductAvailable=t.data.content})).finally((function(){return e.isLoadingAvailable=!1}))}},pagination:{handler:function(){this.getItemsStock()},deep:!0}},created:function(){this.setHeaders()},methods:{editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},exportPrint:function(){var t=this,e=this,s={};null!==e.filter.type_movement&&(s["type_movement"]=e.filter.type_movement),this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/print",params:s,responseType:"blob"}).then((function(e){var s=new Blob([e.data],{type:e.data.type}),o=URL.createObjectURL(s);t.editPdf(o)})),this.$store.dispatch("showNotification",{statut:!1})},exportPDF:function(){var t=this,e={};null!==t.filter.category&&(e["category"]=t.filter.category),this._.isEmpty(this._search)||(this._search=this._.merge(e,this._search)),t.$store.dispatch("request",{url:t.urlItemsExportStock_movement+"/print",params:e,responseType:"blob"}).then((function(t){var e="Listes des produits",s=new Blob([t.data],{type:t.data.type});Qt.saveAs(s,e)})),this.$store.dispatch("showNotification",{statut:!1})},getOpenCash:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsCash}).then((function(s){var o=s.data;t.isInventory=o.content.is_inventory,e(s)}))}))},resetDate:function(){this.formData.date=null,this.menu5=!1,this.$refs.menu5.save(this.formData.date)},getOptionsExport:function(){var t=this;this._.each(this.$store.getters.export,(function(e){t.optionsExport.type_Export.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},itemMovement:function(){this.loadingItemBills.refresh=!0,this.getItemBills().then((function(){})).catch((function(){})).then((function(){self.loadingItemBills.refresh=!1}))},getDataForm:function(){var t={product:this.formData.product.product["id"],end_date:this.formData.end_date,storage_depots:this.$route.params.id,start_date:this.formData.start_date};return t},getMethod:function(){return this.form.id?"PUT":"POST"},getItemsStock:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return null!==e.formData.date&&(a["date"]=e.formData.date),null!==e.formData.productAvailable&&(a["ingredient"]=e.formData.productAvailable.ingredient.id),this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loading.list=!0,e.$store.dispatch("request",{url:e.urlItems+"/specify?storage_depots="+t.$route.params.id,params:a}).then((function(t){var o=t.data;e.itemsStock_available=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loading.list=!1,s()}))}))},showAvailable:function(){this.showStock_available=!0,this.showItem_movements=!1,this.showStocks_movements=!1,this.showInventories=!1},updateExpiry:function(t){this.$refs.updateExpiryDate.setForm(t),this.dialogForm.shows.showInfo=!0,this.messages={title:"$vuetify.product.update.title",submit:"$vuetify.product.update.submit",success:"$vuetify.product.update.success"}},setHeaders:function(){this.headersStock_available=[{text:"$vuetify.product.cols.code.title",value:"code",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"},{text:"$vuetify.product.cols.name.title",value:"name",align:"start",sortable:!0,width:"15",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.quantity_gramme.title",value:"quantity",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.quantity.title",value:"quantity_two",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.bills.cols.actions.title",value:null,align:"start",sortable:!0,width:"140"}]},showFilter:function(){this.dialogForm.shows.showFilter=!0},showFilterMovement:function(){this.dialogFormFilterMov.shows.showFilter=!0},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.code&&(e["code"]=t.filter.code),null!==t.filter.role&&(e["role"]=t.filter.role),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))},performFilterMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.getStockMovement()},assignEnterprise:function(t){this.dialogEnt.show=!0,this.$refs.assignForm.setForm(t)}},computed:{stockAvailableWithTotal:function(){return this.itemsStock_available.map((function(t){return Object(Vt["a"])(Object(Vt["a"])({},t),{},{total:t.qte_stock*t.cmup})}))},get_amount_total:function(){var t=0;return this.itemsStock_available.forEach((function(e){t+=e.qte_stock*e.cmup})),t},get_quantity_total:function(){var t=0;return this.itemsStock_available.forEach((function(e){t+=e.qte_stock})),t},getMinStartDate:function(){var t,e="";return e=null===(t=new Date(this.formData.start_date))||void 0===t?void 0:t.toISOString().substr(0,10),e},get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.product.code,e}},mounted:function(){this.getOpenCash(),this.showAvailable(),this.getItemsStock()},components:{DeleteItem:zt,FormUpdate:Nt}},Wt=Kt,Gt=Object(v["a"])(Wt,qt,At,!1,null,"18e76ef4",null),Jt=Gt.exports;h()(Gt,{VAutocomplete:A["a"],VBtn:p["a"],VCard:_["a"],VCol:M["a"],VDataTable:O["a"],VDatePicker:Ft["a"],VForm:B["a"],VHover:T["a"],VIcon:j["a"],VMenu:St["a"],VRow:N["a"],VSpacer:$["a"],VTextField:L["a"],VTooltip:U["a"]});var Xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._.includes(this.$auth.user().permissions,"view_inventory")?s("div",[s("v-card",{staticClass:"pb-4"},[s("div",{staticClass:"mt-5 mx-5"},[t._.includes(this.$auth.user().permissions,"add_inventory")?[s("v-btn",{staticClass:"mr-2 my-2",attrs:{color:"primary",dark:""},on:{click:function(e){return t.createInventory()}}},[s("v-icon",[t._v(" mdi-plus ")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.add"))+" ")],1)]:t._e(),s("v-btn",{staticClass:"mr-2 my-2",attrs:{loading:t.loadingInventory.refresh,depressed:"",color:"#f1f5fc"},on:{click:function(e){return t.refreshInventory()}}},[s("v-icon",{attrs:{left:"",color:"primary"}},[t._v("mdi-refresh")]),t._v(" "+t._s(t.$vuetify.lang.t("$vuetify.btn.refresh"))+" ")],1),s("v-spacer")],2)]),s("v-card",[s("v-data-table",{staticClass:"mt-5",attrs:{"footer-props":{"items-per-page-options":t.itemPerPageOptions},headers:t.headersInventory,items:t.itemsInventory,"items-per-page":t.itemPerPage,loading:t.loadingInventory.list,options:t.pagination,"server-items-length":t.meta.totalElements,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"item-key":"name"},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header.code",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.date_inventory",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.reason_inventory",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"header.null",fn:function(e){var o=e.header;return[s("tr",[t._v(" "+t._s(t.$vuetify.lang.t(o.text))+" ")])]}},{key:"body",fn:function(e){var o=e.items;return[s("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return s("tbody",{},t._l(o,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"subtitle-2"},[t._v(t._s(e.code))]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(t.$moment(e.createdAt).format("YYYY-MM-DD"))+" "+t._s(e.timeAt)+" ")]),s("td",{staticClass:"subtitle-2"},[t._v(" "+t._s(e.reason_inventory)+" ")]),s("td",{staticClass:"subtitle-2"},[[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"secondary",icon:"",text:""},on:{click:function(s){return t.editInventory(e)}}},a),[s("v-icon",[t._v("mdi-update")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.edit")))])]),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on;return[s("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.smAndDown||i,expression:"$vuetify.breakpoint.smAndDown || hover"}],attrs:{color:"red",icon:"",text:"",dark:""},on:{click:function(s){return t.deleteItem(e)}}},a),[s("v-icon",[t._v("mdi-delete-outline")])],1)]}}],null,!0)},[s("span",[t._v(t._s(t.$vuetify.lang.t("$vuetify.btn.remove")))])])]],2)])})),0)}}],null,!0)})]}}],null,!1,2093764881)}),s("form-inventory",{ref:"inventoryForm",attrs:{dialog:t.dialogFormInventory,form:t.form,messages:t.messages},on:{getItems:t.get_inventory}}),s("delete-item",{attrs:{dialog:t.dialogDelete,messages:t.messagesDelete,urlItems:t.urlDeleteItems},on:{getItems:t.getItems}})],1)],1):t._e()])},Zt=[],te=s("21a6");pt["a"].component("downloadExcel",_t["a"]);var ee={mixins:[a["a"]],data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{start_date:null,end_date:null,product:null,productAvailable:null,date:null,optionExport:null},optionMovement:{type_Movement:[]},itemsInventory:[],itemsItemBills:[],headersInventory:[],itemsProduct:[],messagesInv:{type:Object,default:function(){return{title:"",success:"",submit:""}}},isInventory:!1,urlItemsCash:"cashs/isOpen",showInventories:!1,showItem_movements:!1,urlProduct:"products",urlItems:"inventories",sortBy:["createdAt","timeAt"],menu5:!1,menu2:!1,search:null,isLoading:!1,menu:!1,optionsExport:{type_Export:[]},loadingStockAvailable:{list:!1,refresh:!1,filter:!1},loadingBtn:!1,loadingInventory:{list:!1,refresh:!1,filter:!1},dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},json_fields:{Code:"product.code",Name:"product.name",DCI:"product.dci1.name",Forme:"product.shape.name",Categorie:"product.category.name",Conditionnement:"product.conditioning",Quantite:"qte_stock",CMUP:"cmup",MontantT:"total"},dialogFormInventory:{show:!1,shows:{showFilter:!1,showInfo:!1}},dialogDelete:{show:!1},dialogDetail:{show:!1},dialogEnt:{show:!1},exports:{id:null,type_movement:null,email:null,code:null,password:null,role:null,is_active:null},form:{type_movement:null,role:null},filter:{type_movement:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.storage_depots.delete.success"}}},watch:{search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}},pagination:{handler:function(){this.get_inventory()},deep:!0}},created:function(){},methods:{editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},exportPrint:function(){var t=this,e=this,s={};null!==e.filter.type_movement&&(s["type_movement"]=e.filter.type_movement),this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/print",params:s,responseType:"blob"}).then((function(e){var s=new Blob([e.data],{type:e.data.type}),o=URL.createObjectURL(s);t.editPdf(o)})),this.$store.dispatch("showNotification",{statut:!1})},exportPDF:function(){var t=this,e={};null!==t.filter.category&&(e["category"]=t.filter.category),this._.isEmpty(this._search)||(this._search=this._.merge(e,this._search)),t.$store.dispatch("request",{url:t.urlItemsExportStock_movement+"/print",params:e,responseType:"blob"}).then((function(t){var e="Listes des produits",s=new Blob([t.data],{type:t.data.type});te.saveAs(s,e)})),this.$store.dispatch("showNotification",{statut:!1})},getOpenCash:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsCash}).then((function(s){var o=s.data;t.isInventory=o.content.is_inventory,e(s)}))}))},resetDate:function(){this.formData.date=null,this.menu5=!1,this.$refs.menu5.save(this.formData.date)},getOptionsExport:function(){var t=this;this._.each(this.$store.getters.export,(function(e){t.optionsExport.type_Export.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},itemMovement:function(){this.loadingItemBills.refresh=!0,this.getItemBills().then((function(){})).catch((function(){})).then((function(){self.loadingItemBills.refresh=!1}))},exportItemMovement:function(){var t=this;t.$store.dispatch("request",{url:t.urlProduct+"/export_items?product="+this.formData.product.product.id+"&start_date="+this.formData.start_date+"&end_date="+this.formData.end_date+"&id="+this.$route.params.id,responseType:"blob"}).then((function(t){var e="Historique des sessions",s=new Blob([t.data],{type:t.data.type});te.saveAs(s,e)}))},getDataForm:function(){var t={product:this.formData.product.product["id"],end_date:this.formData.end_date,storage_depots:this.$route.params.id,start_date:this.formData.start_date};return t},getMethod:function(){return this.form.id?"PUT":"POST"},refreshInventory:function(){var t=this;this.loadingInventory.refresh=!0,this.get_inventory().then((function(){})).catch((function(){})).then((function(){t.loadingInventory.refresh=!1}))},get_inventory:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loading.list=!0,e.$store.dispatch("request",{url:e.urlItems+"?storage_depots="+t.$route.params.id,params:a}).then((function(t){var o=t.data;e.itemsInventory=o.content,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loading.list=!1,s()}))}))},setHeadersInventory:function(){this.headersInventory=[{text:"$vuetify.inventory.cols.code.title",value:"code",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"},{text:"$vuetify.inventory.cols.date_inventory.title",value:"date_inventory",align:"start",sortable:!0,width:"15",class:"grey--text text--darken-3"},{text:"$vuetify.inventory.cols.reason_inventory.title",value:"reason_inventory",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.product.cols.actions.title",value:null,align:"start",sortable:!0,width:"12"}]},createInventory:function(){this.dialogFormInventory.show=!0,this.messages={title:"$vuetify.inventory.new.title",submit:"$vuetify.inventory.new.submit",success:"$vuetify.inventory.new.success"},this.$refs.inventoryForm.setForm()},editInventory:function(t){this.dialogFormInventory.show=!0,this.messages={title:"$vuetify.inventory.update.title",submit:"$vuetify.inventory.update.submit",success:"$vuetify.inventory.update.success"},this.$refs.inventoryForm.setForm(t)},showFilter:function(){this.dialogForm.shows.showFilter=!0},showFilterMovement:function(){this.dialogFormFilterMov.shows.showFilter=!0},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.code&&(e["code"]=t.filter.code),null!==t.filter.role&&(e["role"]=t.filter.role),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))}},computed:{getMinStartDate:function(){var t,e="";return e=null===(t=new Date(this.formData.start_date))||void 0===t?void 0:t.toISOString().substr(0,10),e},get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.product.code,e}},mounted:function(){this.getOpenCash(),this.get_inventory()},components:{FormInventory:mt,DeleteItem:x["a"]}},se=ee,oe=Object(v["a"])(se,Xt,Zt,!1,null,"4275848f",null),ie=oe.exports;h()(oe,{VBtn:p["a"],VCard:_["a"],VDataTable:O["a"],VHover:T["a"],VIcon:j["a"],VSpacer:$["a"],VTooltip:U["a"]});var ae=s("21a6");pt["a"].component("downloadExcel",_t["a"]);var ne={mixins:[a["a"]],data:function(){return{maxDate:(new Date).toISOString().substr(0,10),formData:{start_date:null,end_date:null,product:null,productAvailable:null,date:null,optionExport:null},optionMovement:{type_Movement:[]},itemsStock_movement:[],itemsItemBills:[],itemsItemSupplies:[],itemsItemStock_movement:[],headersItemStock_movement:[],headersItemSupplies:[],headersItemBills:[],headersStock_movement:[],itemsProduct:[],messagesInv:{type:Object,default:function(){return{title:"",success:"",submit:""}}},isInventory:!1,urlItemsCash:"cashs/isOpen",showStock_available:!1,show_stocks_movements:!1,showInventories:!1,showItem_movements:!1,urlProduct:"products",urlItems:"/cash_movements",urlProductPlus:"details_stocks/specify",urlItemsBills:"details_bills/get_items",urlItemsSupplies:"details_supplies/get_items",urlItemsStock_movement:"details_stock_movement/get_items",urlItemsExportStock_movement:"stock_movements",urlItemsStock:"details_stocks/stock_available",urlStock_movement:"stock_movements",sortBy:["createdAt","timeAt"],menu5:!1,menu2:!1,search:null,isLoading:!1,menu:!1,optionsExport:{type_Export:[]},dialogFormInv:{show:!1,shows:{showFilter:!1,showInfo:!1}},loadingBtn:!1,loadingItemStock_movement:{list:!1,refresh:!1,filter:!1},loadingItemSupplies:{list:!1,refresh:!1,filter:!1},loadingItemBills:{list:!1,refresh:!1,filter:!1},loadingStockMovement:{list:!1,refresh:!1,filter:!1},dialogForm:{show:!1,shows:{showFilter:!1,showInfo:!1}},json_fields:{Code:"product.code",Name:"product.name",DCI:"product.dci1.name",Forme:"product.shape.name",Categorie:"product.category.name",Conditionnement:"product.conditioning",Quantite:"qte_stock",CMUP:"cmup",MontantT:"total"},dialogDelete:{show:!1},dialogDetail:{show:!1},dialogEnt:{show:!1},exports:{id:null,type_movement:null,email:null,code:null,password:null,role:null,is_active:null},form:{type_movement:null,role:null},filter:{type_movement:null,role:null},messages:{title:"",submit:"",success:""},messagesDelete:{success:"$vuetify.storage_depots.delete.success"}}},watch:{search:function(t){var e=this;if(null!==t){var s={name:t},o=this;this.isLoading=!0,this.$store.dispatch("request",{url:o.urlProductPlus+"?storage_depots="+this.$route.params.id,params:s}).then((function(t){o.itemsProduct=t.data.content})).finally((function(){return e.isLoading=!1}))}}},created:function(){this.setHeadersItemBills(),this.setHeadersItemSupplies(),this.setHeadersItemStock_movement(),this.getOptionsExport(),this.getOptionsMovement()},methods:{getOptionsMovement:function(){var t=this;this._.each(this.$store.getters.type_Movement_stock,(function(e){t.optionMovement.type_Movement.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},editPdf:function(t){this.dialogFormPdf.show=!0,this.$refs.pdfForm.setForm(t)},exportPrint:function(){var t=this,e=this,s={};null!==e.filter.type_movement&&(s["type_movement"]=e.filter.type_movement),this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/print",params:s,responseType:"blob"}).then((function(e){var s=new Blob([e.data],{type:e.data.type}),o=URL.createObjectURL(s);t.editPdf(o)})),this.$store.dispatch("showNotification",{statut:!1})},exportPDF:function(){var t=this,e={};null!==t.filter.category&&(e["category"]=t.filter.category),this._.isEmpty(this._search)||(this._search=this._.merge(e,this._search)),t.$store.dispatch("request",{url:t.urlItemsExportStock_movement+"/print",params:e,responseType:"blob"}).then((function(t){var e="Listes des produits",s=new Blob([t.data],{type:t.data.type});ae.saveAs(s,e)})),this.$store.dispatch("showNotification",{statut:!1})},showExportMovement:function(){this.dialogFormExportMovement.shows.showFilter=!0},performExportMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.getItemsExportMovement()},getItemsExportMovement:function(){var t=this,e=this,s={};this._.isEmpty(this._search)||(this._search=this._.merge(s,this._search)),e.$store.dispatch("request",{url:e.urlItemsExportStock_movement+"/export",params:s,responseType:"blob"}).then((function(e){var s="Liste des mouvements de stock",o=new Blob([e.data],{type:e.data.type});ae.saveAs(o,s),t.dialogFormExportMovement.shows.showFilter=!1}))},getOpenCash:function(){var t=this;return new Promise((function(e){t.$store.dispatch("request",{url:t.urlItemsCash}).then((function(s){var o=s.data;t.isInventory=o.content.is_inventory,e(s)}))}))},resetDate:function(){this.formData.date=null,this.menu5=!1,this.$refs.menu5.save(this.formData.date)},getOptionsExport:function(){var t=this;this._.each(this.$store.getters.export,(function(e){t.optionsExport.type_Export.push({text:t.$vuetify.lang.t(e.text),value:e.value})}))},itemMovement:function(){this.loadingItemBills.refresh=!0,this.getItemBills().then((function(){})).catch((function(){})).then((function(){self.loadingItemBills.refresh=!1}))},exportItemMovement:function(){var t=this;t.$store.dispatch("request",{url:t.urlProduct+"/export_items?product="+this.formData.product.product.id+"&start_date="+this.formData.start_date+"&end_date="+this.formData.end_date+"&id="+this.$route.params.id,responseType:"blob"}).then((function(t){var e="Historique des sessions",s=new Blob([t.data],{type:t.data.type});ae.saveAs(s,e)}))},getDataForm:function(){var t={product:this.formData.product.product["id"],end_date:this.formData.end_date,storage_depots:this.$route.params.id,start_date:this.formData.start_date};return t},getMethod:function(){return this.form.id?"PUT":"POST"},getItemBills:function(){var t=this,e=this,s=this.pagination,o=s.page,i=s.itemsPerPage,a={page:o,size:i};return a["storage_depots"]=this.$route.params.id,null!==e.formData.start_date&&(a["start_date"]=e.formData.start_date),null!==e.formData.end_date&&(a["end_date"]=e.formData.end_date),null!==e.formData.product&&(a["product"]=e.formData.product.product.id),this._.isEmpty(this._search)||(this._search=this._.merge(a,this._search)),new Promise((function(s,o){t.loadingItemBills.list=!0,e.$store.dispatch("request",{url:e.urlItemsStock_movement,method:"GET",params:a}).then((function(t){var o=t.data;e.itemsItemBills=o.content.bills,e.meta={totalElements:o.totalElements},s(t)})).catch((function(s){var i=t.$vuetify.lang.t("$vuetify.error_occured");if(s.response)if(400===s.response.status){var a=s.response.data;e.setFormErrors(a);var n=Object.keys(a)[0];n&&Array.isArray(a[n])&&(i=a[n][0])}else 403===s.response.status?i=e.$vuetify.lang.t("$vuetify.error_denied"):500===s.response.status&&(i=e.$vuetify.lang.t("$vuetify.error_server"));e.$store.dispatch("showNotification",{status:!0,text:i}),o(s)})).then((function(){e.loadingItemBills.list=!1,s()}))}))},setHeadersItemBills:function(){this.headersItemBills=[{text:"$vuetify.bills.cols.code.title",value:"code",align:"start",sortable:!0,width:"80",class:"grey--text text--darken-3"},{text:"$vuetify.expenses_nature.title",value:"type_movement",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.name.title",value:"name",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.date_movement.title",value:"date_movement",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.stock_initial.title",value:"stock_initial",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity_used.title",value:"quantity_used",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity.title",value:"quantity",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"}]},setHeadersItemSupplies:function(){this.headersItemSupplies=[{text:"$vuetify.supplies.cols.code.title",value:"code",align:"start",sortable:!0,width:"80",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.supplier.title",value:"suppliers",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.created.title",value:"createdAt",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.stock_initial.title",value:"stock_initial",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.quantity.title",value:"quantity",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.arrival_price.title",value:"arrival_price",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.supplies.cols.total_amount.title",value:"total_amount",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"}]},setHeadersItemStock_movement:function(){this.headersItemStock_movement=[{text:"$vuetify.stock_movement.cols.code.title",value:"code",align:"start",sortable:!0,width:"150",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.date_movement.title",value:"date_movement",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.stock_initial.title",value:"stock_initial",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.quantity.title",value:"quantity",align:"start",sortable:!0,width:"100",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.unit_price.title",value:"unit_price",align:"start",sortable:!0,width:"20",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.total_amount.title",value:"total_amount",align:"start",sortable:!0,width:"30",class:"grey--text text--darken-3"}]},refreshStockMovement:function(){var t=this;this.loadingStockMovement.refresh=!0,this.getStockMovement().then((function(){})).catch((function(){})).then((function(){t.loadingStockMovement.refresh=!1}))},showAvailable:function(){var t=this;this.showStock_available=!0,this.showItem_movements=!1,this.show_stocks_movements=!1,this.showInventories=!1,this.$nextTick((function(){var e;null===(e=t.$refs.form_available)||void 0===e||e.getItemsStock()}))},showStock_movements:function(){var t=this;this.show_stocks_movements=!0,this.showStock_available=!1,this.showItem_movements=!1,this.showInventories=!1,this.$nextTick((function(){var e;null===(e=t.$refs.form_movement)||void 0===e||e.get_stock_movement()}))},showInventory:function(){var t=this;this.showInventories=!0,this.showStock_available=!1,this.showItem_movements=!1,this.show_stocks_movements=!1,this.$nextTick((function(){var e;null===(e=t.$refs.form_inventory)||void 0===e||e.get_inventory()}))},createInv:function(){this.dialogFormInv.show=!0,this.messagesInv={title:"$vuetify.cash_movement.title_warning_cash",submit:"$vuetify.cash.new.submit",success:"$vuetify.cash.new.success"}},showItemMovements:function(){this.showItem_movements=!0,this.showStock_available=!1,this.show_stocks_movements=!1,this.showInventories=!1},setHeadersStock_movement:function(){this.headersStock_movement=[{text:"$vuetify.stock_movement.cols.code.title",value:"code",align:"start",sortable:!0,width:"50",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.date_movement.title",value:"date_movement",align:"start",sortable:!0,width:"15",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.type_movement.title",value:"type_movement",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.reason_movement.title",value:"reason_movement",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.product_code.title",value:"product_code",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.stock_movement.cols.movement_value.title",value:"movement_value",align:"start",sortable:!0,width:"1",class:"grey--text text--darken-3"},{text:"$vuetify.product.cols.actions.title",value:null,align:"start",sortable:!0,width:"12"}]},createMovement:function(){this.dialogFormStock_movement.show=!0,this.messages={title:"$vuetify.stock_movement.new.title",submit:"$vuetify.stock_movement.new.submit",success:"$vuetify.stock_movement.new.success"}},editStock_movement:function(t){this.dialogFormStock_movement.show=!0,this.messages={title:"$vuetify.stock_movement.update.title",submit:"$vuetify.stock_movement.update.submit",success:"$vuetify.stock_movement.update.success"},this.$refs.stock_movementForm.setForm(t)},showFilter:function(){this.dialogForm.shows.showFilter=!0},showFilterMovement:function(){this.dialogFormFilterMov.shows.showFilter=!0},performFilter:function(){var t=this;t.loading.list=!0;var e={};null!==t.filter.code&&(e["code"]=t.filter.code),null!==t.filter.role&&(e["role"]=t.filter.role),t._search=e,t.getItems().then((function(){t.$refs.filterForm.closeDialog()})).finally((function(){t.$refs.filterForm.stopLoadingBtn()}))},performFilterMovement:function(){var t=this,e={};null!==t.filter.type_movement&&(e["type_movement"]=t.filter.type_movement),t._search=e,t.getStockMovement()},assignEnterprise:function(t){this.dialogEnt.show=!0,this.$refs.assignForm.setForm(t)}},computed:{getMinStartDate:function(){var t,e="";return e=null===(t=new Date(this.formData.start_date))||void 0===t?void 0:t.toISOString().substr(0,10),e},get_product_code:function(){var t,e="";return e=null===this.formData.product?"":null===(t=this.formData.product)||void 0===t?void 0:t.product.code,e}},mounted:function(){this.getOpenCash()},components:{FormItems:Pt,FormMovement:kt,FormAvailable:Jt,FormInventory:ie}},re=ne,le=s("a523"),ue=s("adda"),ce=s("8270"),me=Object(v["a"])(re,o,i,!1,null,"3ec4259b",null);e["default"]=me.exports;h()(me,{VBtn:p["a"],VCol:M["a"],VContainer:le["a"],VImg:ue["a"],VListItemAvatar:ce["a"],VRow:N["a"]})},bb43:function(t,e,s){t.exports=s.p+"img/ready-stock2.80ea4da8.png"},ceac:function(t,e,s){t.exports=s.p+"img/stock-rotation.ba51659f.png"},fa0a:function(t,e,s){t.exports=s.p+"img/docs_stock.a278d425.png"}}]);
//# sourceMappingURL=chunk-51124343.1959bee6.js.map